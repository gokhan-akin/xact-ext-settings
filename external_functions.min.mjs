//!FIXME: webdial.unidial has no Copy From Dialer function / doesn't work, saves Empty customer data
export const check={mxfree:async e=>{{let t=e.split("@");const n=`https://api.experte.com/tools/email-finder?name=${t[0]}&domain=${t[1]}`;let i=await fetch(n,{method:"GET"});return i.ok?(await i.json()??[null])[0]:null}},mx:async e=>{let t=e.split("@"),n={email:e,status:"invalid",format_valid:!1,mx_found:!1,server_connection:!1,server_response:!1,valid_user:!1,catch_all:!1,message:""};const i=`https://api.experte.com/tools/email-finder?name=${t[0]}&domain=${t[1]}`;return await fetch(i,{method:"GET"}).then((e=>e.ok?e.json():null)).then((e=>{n=e[0]})).catch((e=>null)),n},vat:async e=>{let t={};return"string"!=typeof e?null:(e=e.replace(/[^ATUDECH0-9]/g,""),await fetch(`https://api.vatcomply.com/vat?vat_number=${e}`,{method:"GET"}).then((e=>e.json())).then((e=>{t=e})).catch((e=>t=null)),t)},place:async({name:e,address:t,nr:n="",zip:i="",number:a="",ccode:r="de",website:o=""})=>{r=r.toLowerCase();let s={geo:{lat:0,lng:0},name:"",address:"",street:"",streetnr:"",zip:"",city:"",ccode:"",phone:"",website:""},l=`https://trueway-geocoding.p.rapidapi.com/Geocode?address=${e} ${t} ${n} ${i}&language=de&&country=${r}`;if(await fetch(l,{method:"GET",headers:{"X-RapidAPI-Key":"b81e47c797msha87b9298cce54cfp101af6jsncdd689a9276b","X-RapidAPI-Host":"trueway-geocoding.p.rapidapi.com"}}).then((e=>e.json())).then((e=>{e&&e.results&&e.results.length?(s.geo.lat=e.results[0].location.lat,s.geo.lng=e.results[0].location.lng):(s.geo.lat=0,s.geo.lng=0)})).catch((e=>console.error(e))),i&&i.length){let a="u5nRykLjS2tDfv0srlIanOqD73QxWZursYpHif5sgYoiF9oT4toCLxWaygNEQNdb",o=null,l={public_key:a,name:e,country:r.toUpperCase(),street:t+(n.length?" "+n:""),city:"",zip:i};0!=s.geo.lat&&0!=s.geo.lng&&(l.lat=s.geo.lat,l.lng=s.geo.len);let d=await fetch("https://uberall.com/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(d&&d.ok&&(o=await d.json()),o&&"SUCCESS"==o.status){let t=await fetch(`https://uberall.com/api/search/${o.response.searchData.id}?public_key=${a}&directory=GOOGLE&token=${o.response.searchData.token}`);if(t&&t.ok){let n=await t.json();"SUCCESS"==n.status&&n.response.result.listingUrl||(l.street=e,d=await fetch("https://uberall.com/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),d&&d.ok&&(o=await d.json()),t=await fetch(`https://uberall.com/api/search/${o.response.searchData.id}?public_key=${a}&directory=GOOGLE&token=${o.response.searchData.token}`),t&&t.ok&&(n=await t.json())),"SUCCESS"==n.status&&n.response.result.listingUrl&&(s.name=n.response.result.name,s.address=n.response.result.streetAndNo,s.street=n.response.result.street,s.streetnr=n.response.result.streetNo,s.zip=n.response.result.zip,s.city=n.response.result.city,s.ccode=n.response.result.country,n.response.result.phone&&(s.phone=n.response.result.phone.replace(/\D/gi,"")),n.response.result.website&&(s.website=n.response.result.website))}}}if(s.name.length<2){let l="https://trueway-places.p.rapidapi.com/FindPlaceByText?text="+e.replace(/&/g,"%26")+" "+t+" "+n+" "+i+" "+("at"==r?"Austria":"Deutschland")+"&language=de";l=new URL(l).toString(),await fetch(l,{method:"GET",headers:{"X-RapidAPI-Key":"b81e47c797msha87b9298cce54cfp101af6jsncdd689a9276b","X-RapidAPI-Host":"trueway-places.p.rapidapi.com"}}).then((e=>e.json())).then((e=>{if(e&&e.results&&e.results.length){var n=-1;if(e.results.length>1&&(n=-1),a.replace(/^(00+|\+)4\d/g,"").replace(/\D/g,"").length>3&&-1==n){let t=a.replace(/^(00+|\+)4\d/g,"").replace(/\D/g,"");n=e.results.findIndex((e=>"phone_number"in e&&e.phone_number.includes(t)))}if(-1==n&&o.length>3&&o.includes(".")){let t=o.replace(/"/g,"").replace(/\//g,"").toLowerCase();t=t.substring(0,t.indexOf(".")),n=e.results.findIndex((e=>"website"in e&&e.website.toLowerCase().includes(t)))}if(-1==n&&(n=e.results.findIndex((e=>e.address.toLowerCase().replace(/\s/g,"").includes(t.toLowerCase().replace(/\s/g,""))&&e.address.toLowerCase().replace(/\s/g,"").includes(i.toLowerCase().replace(/\s/g,""))&&!e.address.startsWith(e.name)))),n>-1&&(e.results[n].address.includes("sterreich")||e.results[n].address.includes("eutschland")||e.results[n].address.includes("ustria")||e.results[n].address.includes("ermany"))){s.name=e.results[n].name,s.website=e.results[n].website??"",s.phone=e.results[n].phone_number??"",s.geo.lat=e.results[n].location.lat??0,s.geo.lng=e.results[n].location.lng??0;let t=e.results[n].address.replace(/,\s(Deutschland|Ã–sterreich|Austria|Germany)/gi,"");s.zip=(t.match(/(?!(\s))(\d\d\d\d)(\d)?(?!=(\s|,))/)??[null])[0],s.city=" "==t[t.indexOf(s.zip)+s.zip.length]?t.substring(t.indexOf(s.zip+" ")+s.zip.length+1).replace(/^\s+|\s+$/g,""):"",t=t.substring(0,t.indexOf(",")),s.address=e.results[n].address.substring(0,e.results[n].address.indexOf(", "+s.zip)),s.streetnr=t.substring(t.lastIndexOf(" ")+1),s.street=t.replace(" "+s.streetnr,""),s.ccode=r.toUpperCase()}}})).catch((e=>console.error(e)))}if(s.name.length<2){let l="https://local-business-data.p.rapidapi.com/search?query="+e+" "+t+" "+n+" "+i+"&limit=5"+(s.geo.lat>0?"&lat="+s.geo.lat+"&lng="+s.geo.lng+"&zoom=13":"")+"&language=de&region="+r;await fetch(l,{method:"GET",headers:{"X-RapidAPI-Key":"b81e47c797msha87b9298cce54cfp101af6jsncdd689a9276b","X-RapidAPI-Host":"local-business-data.p.rapidapi.com"}}).then((e=>e.json())).then((e=>{if(e&&e.data&&e.data.length>0){var n=-1;if(e.data.length>1&&(n=-1),a.replace(/^(00+|\+)4\d/g,"").replace(/\D/g,"").length>3&&-1==n){let t=a.replace(/^(00+|\+)4\d/g,"").replace(/\D/g,"");n=e.data.findIndex((e=>null!=e.phone_number&&("phone_number"in e&&e.phone_number.includes(t))))}if(-1==n&&o.length>3&&o.includes(".")){let t=o.replace(/"/g,"").replace(/\//g,"").toLowerCase();t=t.substring(0,t.indexOf(".")),n=e.data.findIndex((e=>null!=e.website&&("website"in e&&e.website.toLowerCase().includes(t))))}-1==n&&e.data&&e.data.address&&(n=e.data.findIndex((e=>e.address.toLowerCase().replace(/\s/g,"").includes(t.toLowerCase().replace(/\s/g,""))&&e.address.toLowerCase().replace(/\s/g,"").includes(i.toLowerCase().replace(/\s/g,""))&&!e.address.startsWith(e.name)))),n>-1&&null!=e.data[n].country&&(e.data[n].country.includes("AT")||e.data[n].country.includes("DE"))&&(s.name=e.data[n].name,s.website=e.data[n].website??"",s.phone=e.data[n].phone_number??"",s.geo.lat=e.data[n].latitude??0,s.geo.lng=e.data[n].longitude??0,s.zip=e.data[n].zipcode,s.city=e.data[n].city,s.address=e.data[n].street_address,s.streetnr=e.data[n].street_address.substring(e.data[n].street_address.lastIndexOf(" ")+1),s.street=e.data[n].street_address.replace(" "+s.streetnr,""),s.ccode=r.toUpperCase())}})).catch((e=>console.error(e)))}return console.log("[checkPlace] biz:",s),s.name.length>2?s:void 0}};export const customersCache={add:async function(e,t=!1){let n=!0,i=0;for(const t in e)if("string"==typeof e[t]&&(e[t].length>1&&i++,i>8)){n=!1;break}if(n)return console.log("[Xact Solution] (customersCache.add) Customer trying to save is completely empty. Not added to customers cache."),null;let a=await this.get();if(!a)return null;let r=await this.searchIndex(e);return r<0?(t=!0,a.push(e)):!a[r].CustomerNumber.length&&e.CustomerNumber.length&&(t=!0,a[r]=e),t&&await this.save(a),e},get:async function(){return await new Promise(((e,t)=>{chrome.storage.local.get("customers",(function(t){chrome.runtime.lastError&&(console.log("[Xact Solution] (getCustomersCache) Err:"+chrome.runtime.lastError.message),e(null)),t&&void 0!==t.customers||(console.log("[Xact Solution] (getCustomersCache) result:",t),e([])),e(t.customers)}))}))},searchold:async function(e){let t=await this.get();return t?(e.CustomerNumber&&e.CustomerNumber.length>3?ckey=e.CustomerNumber:e.Email&&e.Email.length>3?ckey=e.Email:e.TelephoneNumber&&e.MobilePhoneNumber&&(e.TelephoneNumber.length>2||e.MobilePhoneNumber.length>2)&&(ckey=e.TelephoneNumber+e.MobilePhoneNumber),ckey?(t[ckey]=e,await this.save(t)):void 0):null},search:async function(e=[]){let t=await this.get(),n=await this.searchIndex(e,t);return"number"!=typeof n&&!n||-1==n?null:t[n]},searchIndex:async function(e=[],t=null){if(t||(t=await this.get()),!t)return-1;function n(e){return t.findIndex((t=>!((e=e.toLowerCase()).length<3)&&(e.length>2&&(t.CustomerNumber??"")==e||(t.LeadID??"").toLowerCase()==e||(t.Website??"").toLowerCase()==e||(t.Email??"").toLowerCase()==e||(t.CompanyName??"").toLowerCase().replace(/\W/gi,"")==e.replace(/\W/gi,"")||e.replace(/\W/gi,"").includes((t.CompanyName??"").toLowerCase().replace(/\W/gi,""))||(t.CompanyName??"").toLowerCase().replace(/\W/gi,"").includes(e.replace(/\W/gi,""))||(t.TelephoneNumber??"")==e||(t.FirstName??"")+" "+(t.LastName??"")==e||(t.MobilePhoneNumber??"")==e)))}"string"==typeof e&&(e=[e]);let i=-1;if(e)if("object"==typeof e){if(Array.isArray(e)||void 0===e.CustomerNumber||(e=[e.CustomerNumber,e.LeadID,e.Email??e.uemail,e.Website??"",e.TelephoneNumber??e.utelenr,e.MobilePhoneNumber??e.umobilnr,e.FirstName??e.uvorname+" "+e.LastName??e.unachname]),Array.isArray(e)&&e.length>0)for(const t of e)if(-1==i&&(i=n(t)),i>-1)return i}else i=n(e);return i},save:async function(e){return console.log("customersCache.save customers:",e),await new Promise(((t,n)=>{chrome.storage.local.set({customers:e},(function(){chrome.runtime.lastError?(console.log("[Xact Solution] Error saving customer data:",chrome.runtime.lastError),t(null)):(console.log("[Xact Solution] Added customer data:",e),t(e))}))}))},onChange:function(e,t){},clear:async function(){return await new Promise(((e,t)=>{chrome.storage.local.remove("customers",(function(){chrome.runtime.lastError&&e(chrome.runtime.lastError),e(!0)}))}))}};export const agentsystem={users:async function(e="movido"){let t=e.includes("spectario")?"agent.spectario.com":e.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",n=await getBearerTokens(e,"agentsystem");return n?(await fetchBg(`https://${t}/api/admin/users`,{method:"GET",headers:{Authorization:n.token,"Content-Type":"application/json"}})).users:null},getUser:async function(e,t="movido"){let n=await this.users(t);return n?n.filter((e=>e.Active&&!e.IsDeleted)).find((t=>t.AgentId==e)):null},productcategory:async function(e="movido"){let t=e.includes("spectario")?"agent.spectario.com":e.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",n=await getBearerTokens(e,"agentsystem");return n?await fetchBg(`https://${t}/api/admin/product-category`,{method:"GET",headers:{Authorization:n.token,"Content-Type":"application/json"}}):null},orderdraft:async function(e="movido",t="5ffdf29f72fb4414901e0743"){let n=e.includes("spectario")?"agent.spectario.com":e.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",i=await getBearerTokens(e,"agentsystem");return i?await fetchBg(`https://${n}/api/agent/order-draft`,{method:"PUT",headers:{Authorization:i.token,"Content-Type":"application/json"},body:JSON.stringify({ProductCategoryId:t})}):null},order:async function(e,t="movido"){let n=t.includes("spectario")?"agent.spectario.com":t.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",i=await getBearerTokens(t,"agentsystem");if(!i)return null;let a=await fetchBg(`https://${n}/api/agent/order/${e}`,{method:"GET",headers:{Authorization:i.token,"Content-Type":"application/json"}});if(!a.order.Agent.AgentName.length){let e=await this.getUser(a.order.Agent.AgentID);e&&(a.order.Agent.AgentName=e.Name)}return a},customers:async function(e="movido",t="",n=100,i=!1){t||(t=""),n||(n=100);let a=e.includes("spectario")?"agent.spectario.com":e.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",r=await getBearerTokens(),o=await fetch(`https://${a}/api/admin/customers?keyword=${t}&sort=asc&page=0&size=${n}`,{method:"GET",headers:{Authorization:r[e.toLowerCase()].agentsystem.token}});if(!o)return null;if(o=await o.json(),i){let e=null,t=null;if(!e||"string"!=typeof e){let t=new Date;t.setUTCHours(0,0,1,0),e=t.toISOString()}if(!t||"string"!=typeof t){let e=new Date;e.setUTCHours(23,59,59,0),t=e.toISOString()}const n=new Date(e),i=new Date(t);o.customers=o.customers.filter((e=>{const t=new Date(e.UpdatedTime);return t>=n&&t<=i}))}return o.customers.sort(((e,t)=>{const n=new Date(e.UpdatedTime);return new Date(t.UpdatedTime)-n})),o.customers},orders:async function(e="movido",t=120,n=void 0,i=void 0){if(t||(t=120),!n||"string"!=typeof n){let e=new Date;e.setUTCHours(0,0,1,0),n=e.toISOString()}if(!i||"string"!=typeof i){let e=new Date;e.setUTCHours(23,59,59,0),i=e.toISOString()}e&&(e=e.toLowerCase());let a=e.includes("spectario")?"agent.spectario.com":e.includes("aadvanto")?"agent.aadvanto.de":"agent.movido-media.de",r=await getBearerTokens();if(r&&r.hasOwnProperty(e)&&r[e].agentsystem){let o=await fetch(`https://${a}/api/agent/orders?sort=asc&page=0&size=${t}&startDate=${n}&endDate=${i}`,{method:"GET",headers:{Authorization:r[e].agentsystem.token}});return o?(o=await o.json(),o.orders.sort(((e,t)=>{const n=new Date(e.UpdatedTime);return new Date(t.UpdatedTime)-n})),o.orders):null}return null}};export const mysiteauditor={check:async function(e,t,n,i){let a="a5eff0aa966887974379287edb9c7b6540923034"==i?"Aadvanto":"ceff67c5eb4bca4063849c4d0454e085243fa041"==i?"Movido":null;const r=Date.now(),o={callback:"jQuery19106226648019322614_"+r,api_key:i,email:t,first_name:"","url[]":[e,"http://"],keyword:n,language:"german",submitted_on:/advanto/gi.test(a)?"https://aadvanto.de/seo-pruefung/":"https://movido-media.de/mein-seo-test/",form:"banner",_:r},s=`https://mysiteauditor.com/user/leads/process_lead/?${Object.keys(o).map((e=>Array.isArray(o[e])?o[e].map((t=>`${e}=${encodeURIComponent(t)}`)).join("&"):`${e}=${encodeURIComponent(o[e])}`)).join("&")}`;try{const e=await fetch(s);if(!e.ok)throw new Error("Network response was not ok");const t=await e.text(),n=t.indexOf("{"),i=t.lastIndexOf("}")+1;return JSON.parse(t.substring(n,i))}catch(e){throw console.error("There was a problem with the fetch operation: ",e),e}},slug:async function(e){const t=String(Math.floor(Date.now()/1e3)),n={slug:e,lead:"1",callback:"jQuery19106226648019322614_"+t,_:t},i=`https://mysiteauditor.com/user/audit_status/?${Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&")}`;try{const e=await fetch(i);if(!e.ok)throw new Error("Network response was not ok");const t=await e.text(),n=t.indexOf("{"),a=t.lastIndexOf("}")+1;return JSON.parse(t.substring(n,a))}catch(e){throw console.error("There was a problem with the fetch operation: ",e),e}},download:async function(e,t,n="SEO CHECK"){const i={slug:e,type:"u",api_key:t,filename:(n??"SEO CHECK").replace(/(\s+)?\.pdf(?=$)/gim,"")},a=Object.keys(i).map((e=>e+"="+encodeURIComponent(i[e]))).join("&");return await new Promise(((e,t)=>{try{fetch("https://mysiteauditor.com/user/leads/download_report",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a}).then((t=>{t.blob().then((t=>{const i=new FileReader;i.onload=function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.scripting.executeScript({target:{tabId:t[0].id},function:function(e,t){const n=document.createElement("a");n.href=e,n.download=(t??"SEO CHECK").replace(/(\s+)?\.pdf(?=$)/gim,""),document.body.appendChild(n),n.click(),document.body.removeChild(n)},args:[i.result,n]}),e(!0)}))},i.readAsDataURL(t)}))})).catch((t=>{console.log("[Xact Solution] (mysiteauditor.download) Fetch Err:",t),e(null)}))}catch(t){console.error("[Xact Solution] mysiteauditor.download ERR:",t),e(null)}}))},seoCheck:async function(e,t,n,i=null,a=null,r="SEO CHECK"){if(!i&&!a)return console.log("[MySiteAuditor] seoCheck: No api_key nor reseller was given.");!a&&i&&(a="a5eff0aa966887974379287edb9c7b6540923034"==i?"Aadvanto":"ceff67c5eb4bca4063849c4d0454e085243fa041"==i?"Movido":null),!i&&a&&(i=/advanto/gi.test(a)?"a5eff0aa966887974379287edb9c7b6540923034":"ceff67c5eb4bca4063849c4d0454e085243fa041");let o=await this.check(e,t,n,i);return await new Promise(((e,t)=>{let n=setInterval((async t=>{let a=await mysiteauditor.slug(t.slug);"pending"!=a.response&&(clearInterval(n),"completed"==a.response?mysiteauditor.download(a.slug,i,r).then((t=>{e(t)})):(console.log("[Xact Solution] (mysiteauditor.seoCheck) Slug Err:",a),e(null)))}),4e3,o)}))}};export const infotec={addCustomer:async function(e,t="movido"){let n=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de",i={action:"create",uemail:"",ufirma:"",uvorname:"",unachname:"",ugeschlecht:"",uadresse:"",uhausnr:"",uplz:"",ustadt:"",uland:"",ucurrency:"",uvorwahl:"",utelenr:"",umobilvorwahl:"",umobilnr:"",ubdayday:"",ubdaymonth:"",ubdayyear:"",unotes:"",ureseller:"",usteuernr:"",uustid:""};if(i&&e&&"object"==typeof e){let a=!1;for(const t in e){if(t.includes("extrafields")&&(a=!0),(!e[t]||!e[t].length)&&/uemail|ufirma|uvorname|unachname|ugeschlecht|uadresse|uhausnr|uplz|ustadt|uland|ucurrency|ureseller/gi.test(t))return console.log("Couldn't create customer in infotec. No value in "+t),null;i[t]=e[t]}if(!i.uemail.includes("@")||!i.uemail.includes("."))return console.log("Couldn't create customer in infotec. Wrong value in uemail:",i.uemail),null;if(i.ugeschlecht="Female"==i.ugeschlecht?"weiblich":"Male"==i.ugeschlecht?"maennlich":i.ugeschlecht,!/^(maennlich|weiblich)$/.test(i.ugeschlecht))return console.log("Couldn't create customer in infotec. Wrong value in ugeschlecht:",i.ugeschlecht),null;if(i.uland.includes("CH")?i.ucurrency="2":i.ucurrency="1",!i.utelenr.length&&!i.umobilnr.length)return console.log("Couldn't create customer in infotec. No Tel.numbers"),null;i.action="create";const r=Object.keys(i).map((e=>e+"="+encodeURIComponent(i[e]))).join("&");console.log("DATA adding to infotec:",i);let o=await fetch(`https://${n}/inagents/index.php?show=com/userverwaltung`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});if(!o||!o.ok)return console.log("Error adding Customer data in Infotec Billing"),null;if(o=await o.text(),!o)return null;let s=o.match(/(?<=">)\d{5,10}(?=<\/)/gim);return s?(a&&await this.updateCustomer(s[0],i,t),console.log("returning",s[0]),s[0]):null}return null},getCustomer:async function(e,t="movido"){let n=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";if(!/^[0-9]+$/gi.test(e)&&"number"!=typeof e)return null;let i=null,a=null;if(a=await fetch(`https://${n}/inagents/index.php?show=com/kundenuebersicht&action=showuser&id=${e}`),!a||!a.ok)return null;if(i=await a.text(),i){let o=i.match(/(?<=Kundendaten\s<\/legend>)(.|\n|\r)+(?=value="Bearbeiten")/gim);if(!o)return null;o=o[0];let s=o.match(/(?<=name=")(.|\n|\r){0,1000}?(?=(\/tr|\/>)|(<\/textarea))/gim),l=o.match(/(?<=select\sname=")(.|\n|\r)+?(?=\/select)/gim);if(s&&l){function r(e){const t={"&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&amp;":"&","&uuml;":"Ã¼","&ouml;":"Ã¶","&auml;":"Ã¤","&Uuml;":"Ãœ","&Ouml;":"Ã–","&Auml;":"Ã„","&gbreve;":"ÄŸ","&ccedil;":"Ã§","&nbsp;":" ","&imath;":"Ä±","&szlig;":"ÃŸ","&ndash;":"-"};return e.replace(/&(lt|gt|quot|#39|amp|uuml|ouml|auml|Uuml|Ouml|Auml|gbreve|ccedil|nbsp|imath|szlig|ndash);/gim,(function(e,n){return t[e]||e}))}let d=null;return s.forEach((e=>{let t=e.match(/^(.|\n|\r)+?(?=")/gim),n=e.match(/(?<=value=").*?(?=")/gim);t&&!n&&(n=e.match(/(?<=">)(.|\n|\r)+$/gim)),t&&n&&(d||(d={}),d[t[0]]=r(decodeURIComponent(n[0])))})),l.forEach((e=>{let t=e.match(/^(.|\n|\r)+?(?=")/gim),n=e.match(/(?<=selected">)(.|\n|\r)+?(?=\s|<)/gim);t&&n&&(d||(d={}),d[t[0]]=r(decodeURIComponent(n[0])))})),d.infotec=await this.getCustomerProducts(e,t,i),d.CustomerNumber=e,d}return null}},searchCustomerByKeywords:async function(e,t="movido",n=!1){let i=[],a=[],r=[],o=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";if(!e||!e.length)return[];if(e=e.replace(/[Ä°Ä±ÅžÅŸÃ‡Ã§ÄžÄŸÃ–Ã¶ÃœÃ¼Ã„Ã¤]/g,(e=>({"Ä°":"I","Ä±":"i","Åž":"S","ÅŸ":"s","Ã‡":"C","Ã§":"c","Äž":"G","ÄŸ":"g","Ã„":"A","Ã¤":"a","Ã–":"O","Ãœ":"U","Ã¶":"o","Ã¼":"u"}[e]))),n){if(n&&(r=await fetch(`https://${o}/inagents/ajax.php?action=searchcustomer&type=address&term=${encodeURIComponent(e)}`),r&&r.ok))try{r=await r.json()}catch(e){r=[]}}else if(a=await fetch(`https://${o}/inagents/ajax.php?action=searchcustomer&term=${encodeURIComponent(e)}`),a&&a.ok)try{a=await a.json()}catch(e){a=[]}else a=[];return i=a.concat(r),i.length&&(i=Array.from(new Set(i.map((e=>e.id)))).map((e=>i.find((t=>t.id===e)))),i.forEach((e=>{e.url=`https://${o}/inagents/index.php?show=com/kundenuebersicht&action=showuser&id=${e.id}`,e.reseller=t.replace(t[0],t[0].toUpperCase())}))),i},searchCustomerByData:async function(e,t=null){if(!e)return[];t||(t=e.Reseller.toLowerCase());let n=[],i={email:e.uemail&&e.uemail.length?e.uemail:e.Email&&e.Email.length?e.Email:null,firma:e.ufirma&&e.ufirma.length?e.ufirma:e.CompanyName&&e.CompanyName.length?e.CompanyName:null,phone:e.uvorwahl&&e.utelenr&&e.uvorwahl.length&&e.utelenr.length?e.uvorwahl+" "+e.utelenr:e.Telephone&&e.Telephone.length?e.Telephone:null,mobile:e.umobilvorwahl&&e.umobilnr&&e.umobilvorwahl.length&&e.umobilnr.length?e.umobilvorwahl+" "+e.umobilnr:e.MobileNumber&&e.MobileNumber.length?e.MobileNumber:null,name:e.uvorname&&e.uvorname.length&&e.unachname&&e.unachname.length?e.uvorname+" "+e.unachname:e.FirstName&&e.FirstName.length&&e.LastName&&e.LastName.length?e.FirstName+" "+e.LastName:null,address:e.uadresse&&e.uadresse.length&&e.uhausnr&&e.uhausnr.length&&e.uplz&&e.uplz.length?e.uadresse+" "+e.uhausnr+" "+e.uplz:e.StreetAddress&&e.StreetAddress.length&&e.HouseNumber&&e.HouseNumber.length&&e.Postcode&&e.Postcode.length?e.StreetAddress+" "+e.HouseNumber+" "+e.Postcode:null};return i.email&&(n=n.concat(await this.searchCustomerByKeywords(i.email,t))),i.firma&&(n=n.concat(await this.searchCustomerByKeywords(i.firma,t))),i.phone&&(n=n.concat(await this.searchCustomerByKeywords(i.phone,t))),i.mobile&&(n=n.concat(await this.searchCustomerByKeywords(i.mobile,t))),i.name&&(n=n.concat(await this.searchCustomerByKeywords(i.name,t))),i.address&&(n=n.concat(await this.searchCustomerByKeywords(i.address,t,!0))),n.length&&(n=Array.from(new Set(n.map((e=>e.id)))).map((e=>n.find((t=>t.id===e))))),n},updateCustomer:async function(e,t,n="movido"){let i=n.includes("spectario")?"billing.spectario.com":n.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";if(!/^[0-9]+$/gi.test(e)&&"number"!=typeof e)return null;let a=await this.getCustomer(e,n);if(a&&t&&"object"==typeof t){for(const e in t)a.hasOwnProperty(e)&&(a[e]=t[e]);a.action="edit",console.log("(infotec) updateCustomer: Data to update:",a);const n=Object.keys(a).map((e=>e+"="+encodeURIComponent(a[e]))).join("&");let r=await fetch(`https://${i}/inagents/index.php?show=com/kundenuebersicht&action=showuser&id=`+e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n});return r&&r.ok?(r=await r.text(),r):(console.log("Error saving Customer data in Infotec Billing"),null)}},getCustomerProducts:async function(e,t="movido",n=null){if(!/^[0-9]+$/gi.test(e)&&"number"!=typeof e)return null;let i=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";if(!n){let t=await fetch(`https://${i}/inagents/index.php?show=com/kundenuebersicht&action=showuser&id=${e}`);if(!t.ok)return null;n=await t.text()}let a=/(?<=\saktive\sProdukte:)(.|\n|\r)+?(?=Benutzer)/gim,r=/(?<=in-aktive\sProdukte:)(.|\n|\r)+?(?=Benutzer)/gim,o=/(?<=<td>)(.|\n|\r)+?(?=<\/td>)/gim,s=/(?<=class="row\d\">)(.|\n|\r)+?(?=<\/tr>)/gim,l=/(?<=\d\d\d\d">).+?(?=<\/a>)/gim,d={products:{active:[],inactive:[]},contracts:{active:[],inactive:[]}},c=n.match(r),p=n.match(a),u=c[0].match(s);if(u){let e=null,t=null;u.forEach((n=>{n.includes("href")?e=n:t=n,e&&t&&(d.products.inactive.push(g(e,t)),e=null,t=null)}))}let m=p[0].match(s);if(m){let e=null,t=null;m.forEach((n=>{n.includes("href")?e=n:t=n,e&&t&&(d.products.active.push(g(e,t)),e=null,t=null)}))}function g(e,t){let n=t.match(o);return{Name:(e.match(l)??[""])[0],Count:n[0],BookingDate:n[1],StartDate:n[2],ServiceStart:n[3],TerminationDate:n[4],ContractEndDate:n[5],Interval:n[6],TerminationLimit:n[7],Price:n[8]}}return d},bookProduct:async function(e,t="movido"){let n=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";if(!e)return null;let i="string"==typeof e?e:"";if("object"==typeof e){if(console.log("typeof data is object. newdata",e," following query:",!(e.userid&&e.userid.length&&e.uproduct&&e.uproduct.length&&e.uresellerid&&e.uresellerid.length&&e.ustarttime&&e.ustarttime.length)),!(e.userid&&e.userid.length&&e.uproduct&&("string"!=typeof e.uproduct||e.uproduct.length)&&e.uresellerid&&e.uresellerid.length&&e.ustarttime&&e.ustarttime.length))return null;"string"==typeof urebate&&(/^[\d\.,]+$/.test(e.urebate)&&(e.urebate=e.urebate.replace(/,/g,".")),e.urebate=parseFloat(e.urebate),e.urebate&&!isNaN(e.urebate)||(e.urebate=0));let t={action:("add","add"),userid:e.userid,contractid:"",contract_name:"",contract_date:"",uproduct:e.uproduct,uanzahl:"1",uproductcustomerid:"",uresellerid:e.uresellerid,uresellerid_text:"",ureseller_barcode_id:"",uagentid:"",uagentid_text:"",ustarttime:e.ustarttime,ulastinvoice:"",unextinvoice_date:"",ustatus:"confirmed",utitel:"",urebate:e.urebate??0,usilentrebate:"yes",upaytargetdays:"10",uleistungszeitraumoffset:"10",uleistungszeitraumoffsettype:"day",uauftragsbestaetigung:"yes",uauftragsbestaetigung_manual:"yes",select_ab_unique:"",ab_preview_htmldata:"",used_document_id:"79",unotes:"",udescription:""};i=Object.keys(t).map((e=>e+"="+encodeURIComponent(t[e]))).join("&");let n=await this.getProductAbHtml(t.userid,t.uproduct,t.ustarttime,t.urebate);if(!n)return null;t.ab_preview_htmldata=correctAbHtml(n,t.wishnettoprice),console.log("Data for booking Product",t)}let a=await fetch(`https://${n}/inagents/index.php?show=com/produktverwaltung`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i});return a&&a.ok?(a=await a.text(),a?(console.log("??? Booked:",/Produkt\szugeordnet!/gim.test(a)),/Produkt\szugeordnet!/gim.test(a)?e.userid:null):null):(console.log("Error adding Customer data in Infotec Billing"),null)},getProductAbHtml:async function(e,t,n,i=0,a="movido"){let r=a.includes("spectario")?"billing.spectario.com":a.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";"string"==typeof i&&(/^[\d\.,]+$/.test(i)&&(i=i.replace(/,/g,".")),i=parseFloat(i),isNaN(i)&&(i=0));let o=await fetch(`https://${r}/inagents/ajax.php?action=getproductabpreview&productid=${t}&userid=${e}&rebate=${i}&anzahl=1&ustarttime=${n}&uleistungszeitraumoffset=10&uleistungszeitraumoffsettype=day`,{method:"POST"});if(!o||!o.ok)return null;o=await o.text();let s=o.match(/(?<=\dpx;\\">)(.|\n|\r)+(?=<\\\/textarea)/gim);return s?(s=decodeHTMLEntities(s[0]),s):null},getCustomerLastUnsentAb:async function(e,t="movido"){let n=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de",i=await fetch(`https://${n}/inagents/index.php?show=com/documentmanager&action=showuserdocuments&userid=${e}`);if(!i||!i.ok)return null;i=await i.text();let a=i.match(/(?<=AB\s(Movido|Aadvanto|Spectario))(.|\n|\r)+?(?=<\/tr>)/gim),r=null;if(!a||!a.length)return null;for(let e=a.length-1;e>=0&&!r;e--)if(console.log("len",a.length,"i",e),!a[e].includes("showsendlog")){let t=a[e].match(/(?<=[^\w]id=)\d+(?=\")/gim);t&&(r=t[0])}return r},sendCustomerAb:async function(e,t="movido"){let n=t.includes("spectario")?"billing.spectario.com":t.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";const i=/(?<=email"\svalue=").+?@.+?\..+?(?="\ssize)/gim,a=/(?<=cols="\d\d"\srows="\d\d">)(.|\n|\r)+?(?=<\/textarea)/gim,r=/(?<=senderemail"\svalue=").+?(?="\ssize)/gim,o=/(?<=attachment_name"\svalue=").+?(?="\ssize)/gim,s=/(?<=extra_attachments"\svalue=").+?(?="\s\/>)/gim,l=/(?<=emailsubject"\svalue=").+?(?="\ssize)/gim;let d=await fetch(`https://${n}/inagents/index.php?show=com/documentmanager&action=senddocument&id=${e}&mailvorlage=20`);if(!d)return console.log("Req was not ok:",d),null;d=await d.text();let c={send:"yes",sendtype:"auto",fax:"",doc_is_html:"no",email:(d.match(i)??[null])[0],emailtext:(d.match(a)??[null])[0],senderemail:(d.match(r)??[null])[0],attachment_name:(d.match(o)??[null])[0],extra_attachments:(d.match(s)??[null])[0],emailsubject:(d.match(l)??[null])[0]};c.email&&c.emailtext&&c.senderemail&&c.attachment_name&&c.extra_attachments&&c.emailsubject&&(c.senderemail=decodeHTMLEntities(c.senderemail),c.emailtext=decodeHTMLEntities(c.emailtext),c.emailsubject=decodeHTMLEntities(c.emailsubject));let p=Object.keys(c).map((e=>e+"="+encodeURIComponent(c[e]))).join("&"),u=await fetch(`https://${n}/inagents/index.php?show=com/documentmanager&action=senddocument&type=&id=${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:p});return u&&u.ok?(u=await u.text(),/E-Mail\sversendet!/gim.test(u)):(console.log("Post was not ok"),null)},checkNonBookedCustomers:async function(e,t){if("number"!=typeof e&&(e=parseInt(e)),"number"!=typeof t&&(t=parseInt(t)),isNaN(e)||isNaN(t))return null;console.log("= Starting Customer checking...");for(let n=e;n<=t;n++){let e=await infotec.getCustomerProducts(n);e.products.active||e.products.inactive||e.contracts.active||e.contracts.inactive||console.warn("This Customer has no Products and Contracts: ",n)}console.log("= Completed Customer checking...")}};export function downloadPdf({data:e,name:t,recheckid:n,zip:i,isrecheck:a=!1,autoDownloadPdf:r=!0}){let o=uberall.generatePdfName({name:t,recheckid:n,zip:i,isrecheck:a});r&&downloadFile(e,o);const s=document.getElementById("aAnlDwn");if(s){s.removeEventListener("click",(()=>{}));const t=document.getElementById("dwnAnlBtn"),n=document.getElementById("btnAnlDwn");t&&(t.style.color="black",n&&(n.style.display=""),s.addEventListener("click",(t=>{downloadFile(e,o)})))}}export function downloadFile(e,t=void 0){fetch(e).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.blob()})).then((e=>{const n=URL.createObjectURL(e),i=document.createElement("a");i.style.display="none",i.href=n,t&&(i.download=t.replace(/(\.)|[^a-zA-Z0-9_]/gi,"_")),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)})).catch((e=>{console.log("Error downloading file:",e)}))}export const correctStr=(e,t="")=>e?e.replace(/rasse/gi,"raÃŸe").replace(/str\./,"straÃŸe").replace(/STR\./,"STRAÃŸE").replace(/Str\./,"StraÃŸe").replace(/Pl\./,"Platz").replace(/pl\./,"platz").replace(/PL\./,"PLATZ").replace(/DR\./,"DOKTOR").replace(/Dr\./,"Doktor").replace(/(?<=(s|S))tr(?=(\.|\s|$))/,"traÃŸe").replace(/(?<=S)TR(?=(\.|\s|$))/,"TRAÃŸE").replace(/(?<=(p|P))l(?=(\.|\s|$))/,"latz").replace(/(?<=P)L(?=(\.|\s|$))/,"LATZ").replace(/St\.(\s)?/,"Sankt ").replace(/\s\s+/g," ").replace(/^\s+|\s+$/g,""):e;export async function sepNo(e){let t=await getList();t=t.deVorwahl;let n=e.replace(/\D/g,"").replace(/(?<=^004\d)0/,"");if(/^4(1|3|9)/gi.test(n)&&(n="00"+n),n.length<7)return{area:"",no:"",mobile:!1};let i={area:n.substring(0,4),no:n.substring(4,n.length),mobile:!1};if(n.startsWith("00431")&&10==i.no.length&&(n=n.replace("00431","00491"),i.area="0049"),(n.startsWith("00436")||n.startsWith("00417")||n.startsWith("00491"))&&(i.mobile=!0),n.startsWith("0049"))if(1==i.mobile)i.area="0"+n.substring(4,7),i.no=n.substring(7);else{i.no=i.no.replace(/^0+/,"");for(var a=5;a>1;a--){let e=i.no.substring(0,a);t.findIndex((t=>t.areacode===e))>-1&&(a=0,i.area="0"+e,i.no=i.no.substring(e.length))}}return i}export function getAgentData(e=void 0,t=""){if((!e||e&&!e.length)&&(!t||t&&!t.length))return null;let n=list.agents,i=-1;return e&&n.findIndex((t=>t.agentid===e)),i<0&&t.length>4&&(i=n.findIndex((e=>{const n=e.name.toLowerCase().replace(/Ã¼/gi,"u").replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/Ã¶/gi,"o").replace(/Ä±/gi,"i").replace(/yz/gi,"vz"),i=t.toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/Ã¼/gi,"u").replace(/Ã¶/gi,"o").replace(/Ä±/gi,"i").replace(/yz/gi,"vz").split(" ");return n.includes(i[0])&&n.includes(i[i.length-1])}))),n[i]}export async function getBearerTokens(e=null,t=null){return await new Promise(((n,i)=>{chrome.storage.local.get("bearer",(a=>{chrome.runtime.lastError&&i("[Xact Solution] "+chrome.runtime.lastError.message),a&&a.bearer||i("[Xact Solution] (getBearerTokens) res:",a,"res.bearer",a.bearer);let r=a.bearer;r=e?r=t?r[e][t]:r[e]:a.bearer,n(r)}))}))}export async function fetchBg(e,t=void 0){let n=await new Promise(((n,i)=>{chrome.runtime.sendMessage({action:"fetch",url:e,init:t},(function(i){chrome.runtime.lastError?(console.log("[Xact Solution] (fetchBg) chrome.runtime.lastError:",chrome.runtime.lastError.message),fetch(e,t).then((e=>{n(e)}))):(console.log("else resolve resp:",i),n(i))}))}));if(!n)return null;if("boolean"==typeof n.bodyUsed){if(!n.ok)return null;try{n=await n.json()}catch(e){n=await n.text()}}return n}export async function getAgentDataFromAgentsystem(e,t=null){if(!(e&&e.length||t&&t.length))return null;let n=await getBearerTokens();if(!n)return console.log("[Xact Solution] (getAgentDataFromAgentsystem) No bearer."),null;let i=[],a=null;n.hasOwnProperty("movido")&&n.movido.hasOwnProperty("agentsystem")&&(a=await fetchBg("https://agent.movido-media.de/api/admin/users",{method:"GET",headers:{Authorization:n.movido.agentsystem.token}}),a||console.log("mvd Req was not ok:",a),a&&"boolean"==typeof a.bodyUsed&&(a=await a.json()),a&&a.users&&(i=i.concat(a.users))),n.hasOwnProperty("aadvanto")&&n.aadvanto.hasOwnProperty("agentsystem")&&(a=await fetchBg("https://agent.aadvanto.de/api/admin/users",{method:"GET",headers:{Authorization:n.aadvanto.agentsystem.token}}),a||console.log("aadv Req was not ok:",a),a&&"boolean"==typeof a.bodyUsed&&(a=await a.json()),a&&a.users&&(i=i.concat(a.users)),console.log("aadv req:",a,"agentlist",i));let r=i.filter((e=>e.Active&&!e.IsDeleted)).find((t=>{const n=t.Name.toLowerCase().replace(/Ã¼/gi,"u").replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/Ã¶/gi,"o").replace(/Ä±/gi,"i").replace(/yz/gi,"vz"),i=e.toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/Ã¼/gi,"u").replace(/Ã¶/gi,"o").replace(/Ä±/gi,"i").replace(/yz/gi,"vz").split(" ");return n.includes(i[0])&&n.includes(i[i.length-1])}));if(console.log("foundUser",r),!r)return console.log("[Xact Solution] (getAgentDataFromAgentsystem) No foundUser."),null;let o={name:r.Name,location:/kayseri/gim.test(r.Office)?"Kayseri":/ankara/gim.test(r.Office)?"Ankara":/k.r.ehir/gim.test(r.Office)?"Kirsehir":/home/gim.test(r.Office)?"Homeoffice":/alanya/gim.test(r.Office)?"Alanya":/.stanbul/gim.test(r.Office)?"Istanbul":/.zmir/gim.test(r.Office)?"Izmir":"Antalya"};return t&&(o.agentid=t.replace(/^630(?=\d{4})/gi,"")),o}export function correctAbHtml(e,t){let n=e.match(/(?<=[^#]top_adresse)(.|\n|\r)+?(?=style)/gim);if(n&&(n=n[0],console.log("topAdresse:",n),/((AT|CH)-\d{4,5})/gm.test(n)&&(console.log("innerhtml:",e),e=e.replaceAll("ber 35 Online","ber 25 Online").replaceAll("ber 40 Online","ber 25 Online"),console.log("new innerhtml:",e)),e.includes("99,00"))){if(!t){let e=window.location.href.match(/(?<=&wishnettoprice=)\d{2,3}(?=.|&)/gi);t=e?e[0]:null}t&&(e=e.replaceAll("99,00",`${t.replace(/(?<=\d{2})(\.|,).+/gi,"")},00`))}return e}function decodeHTMLEntities(e){return e.replace(/\\(r|n|t)/gim,"").replace(/\\/gim,"").replace(/(\/\*)(.|\n|\r)+?(\*\/)/gim,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/&uuml;/g,"Ã¼").replace(/&ouml;/g,"Ã¶").replace(/&auml;/g,"Ã¤").replace(/&Uuml;/g,"Ãœ").replace(/&Ouml;/g,"Ã–").replace(/&Auml;/g,"Ã„").replace(/&gbreve;/g,"ÄŸ").replace(/&ccedil;/g,"Ã§").replace(/&Ccedil;/g,"Ã§").replace(/&nbsp;/g," ").replace(/&imath;/g,"Ä±").replace(/&szlig;/g,"ÃŸ").replace(/&ndash;/g,"-")}export async function orderCorrections(e,t){}export async function getOrderBG(e=void 0,t=void 0,n=void 0){const i={CompanyName:"",get AF13909(){return this.CompanyName},set AF13909(e){this.CompanyName=e},get ufirma(){return this.CompanyName},set ufirma(e){this.CompanyName=e},get Company(){return this.CompanyName},set Company(e){this.CompanyName=e},get firmenname(){return this.CompanyName},set firmenname(e){this.CompanyName=e},get company_name(){return this.CompanyName},set company_name(e){this.CompanyName=e},VATId:"",get TaxID(){return this.VATId},set TaxID(e){this.VATId=e},get UStID(){return this.VATId},set UStID(e){this.VATId=e},get AF15550(){return this.VATId},set AF15550(e){this.VATId=e},get uustid(){return this.VATId},set uustid(e){this.VATId=e},get steuernummer(){return this.VATId},set steuernummer(e){this.VATId=e},Website:"",get AF13912(){return this.Website},set AF13912(e){this.Website=e},get Webseite(){return this.Website},set Webseite(e){this.Website=e},get webseite(){return this.Website},set webseite(e){this.Website=e},get"extrafields[Webseite]"(){return this.Website},set"extrafields[Webseite]"(e){this.Website=e},FreeText:"",get Notes(){return this.FreeText},set Notes(e){this.FreeText=e},get comments(){return this.FreeText},set comments(e){this.FreeText=e},get unotes(){return this.FreeText},set unotes(e){this.FreeText=e},Country:"",get CountryID(){return this.Country},set CountryID(e){this.Country=e},get country(){return this.Country},set country(e){this.Country=e},get land(){return this.Country},set land(e){this.Country=e},get address3(){return this.Country},set address3(e){this.Country=e},Currency:"",get CurrencyID(){return this.Currency},set CurrencyID(e){this.Currency=e},Subcontractor:"",get SubcontractorID(){return this.Subcontractor},set SubcontractorID(e){this.Subcontractor=e},AnalysisLink:"",get AF13916(){return this.AnalysisLink},set AF13916(e){this.AnalysisLink=e},get additional_field2(){return this.AnalysisLink},set additional_field2(e){this.AnalysisLink=e},AgentName:"",get AgentID(){return this.AgentName},set AgentID(e){this.AgentName=e},AgentIDEnterprise:"",FirstName:"",get first_name(){return this.FirstName},set first_name(e){this.FirstName=e},get uvorname(){return this.FirstName},set uvorname(e){this.FirstName=e},LastName:"",get last_name(){return this.LastName},set last_name(e){this.LastName=e},get unachname(){return this.LastName},set unachname(e){this.LastName=e},get gfinhaber(){return this.FirstName+" "+this.LastName},get kontoinhaber(){return this.FirstName+" "+this.LastName},Email:"",get email(){return this.Email},set email(e){this.Email=e},get uemail(){return this.Email},set uemail(e){this.Email=e},Salutation:"",get Gender(){return this.Salutation},set Gender(e){this.Salutation=e},get title_field(){return this.Salutation},set title_field(e){this.Salutation=e},get title(){return this.Salutation},set title(e){this.Salutation=e},get ugeschlecht(){return this.Salutation},set ugeschlecht(e){this.Salutation=e},get salutation(){return this.Salutation},set salutation(e){this.Salutation=e},Street:"",get StreetAddress(){return this.Street},set StreetAddress(e){this.Street=e},get address1(){return this.Street},set address1(e){this.Street=e},get uadresse(){return this.Street},set uadresse(e){this.Street=e},get anschrift(){return this.Street+" "+this.HouseNumber},set anschrift(e){this.Street=e},HouseNumber:"",get address2(){return this.HouseNumber},set address2(e){this.HouseNumber=e},get uhausnr(){return this.HouseNumber},set uhausnr(e){this.HouseNumber=e},AdditionalAddress:"",City:"",get city(){return this.City},set city(e){this.City=e},get ustadt(){return this.City},set ustadt(e){this.City=e},get ort(){return this.Postcode+" "+this.City},Postcode:"",get PostalCode(){return this.Postcode},set PostalCode(e){this.Postcode=e},get postal_code(){return this.Postcode},set postal_code(e){this.Postcode=e},get uplz(){return this.Postcode},set uplz(e){this.Postcode=e},TelephoneNumberCode:"",get TelephoneCode(){return this.TelephoneNumberCode},set TelephoneCode(e){this.TelephoneNumberCode=e},get phone_code(){return this.TelephoneNumberCode},set phone_code(e){this.TelephoneNumberCode=e},get uvorwahl(){return this.TelephoneNumberCode},set uvorwahl(e){this.TelephoneNumberCode=e},TelephoneNumber:"",get Telephone(){return this.TelephoneNumber},set Telephone(e){this.TelephoneNumber=e},get phone_number(){return this.TelephoneNumber},set phone_number(e){this.TelephoneNumber=e},get utelenr(){return this.TelephoneNumber},set utelenr(e){this.TelephoneNumber=e},get telefon(){return this.TelephoneNumber},set telefon(e){this.TelephoneNumber=e},get phone_numberDISP(){return this.TelephoneNumber},set phone_numberDISP(e){this.TelephoneNumber=e},MobilePhoneNumberCode:"",get MobileNumberCode(){return this.MobilePhoneNumberCode},set MobileNumberCode(e){this.MobilePhoneNumberCode=e},get umobilvorwahl(){return this.MobilePhoneNumberCode},set umobilvorwahl(e){this.MobilePhoneNumberCode=e},MobilePhoneNumber:"",get MobileNumber(){return this.MobilePhoneNumber},set MobileNumber(e){this.MobilePhoneNumber=e},get alt_phone(){return this.MobilePhoneNumber},set alt_phone(e){this.MobilePhoneNumber=e},get umobilnr(){return this.MobilePhoneNumber},set umobilnr(e){this.MobilePhoneNumber=e},get mobilfunk(){return this.MobilePhoneNumber},set mobilfunk(e){this.MobilePhoneNumber=e},LeadID:"",get lead_id(){return this.LeadID},set lead_id(e){this.LeadID=e},get leadID(){return this.LeadID},set leadID(e){this.LeadID=e},ContactPerson:"",get custom1(){return this.ContactPerson},set custom1(e){this.ContactPerson=e},get ansprechpartner(){return this.ContactPerson},set ansprechpartner(e){this.ContactPerson=e},Industry:"",get AF13913(){return this.Industry},set AF13913(e){this.Industry=e},get branche(){return this.Industry},set branche(e){this.Industry=e},Keywords:"",get AF13914(){return this.Keywords},set AF13914(e){this.Keywords=e},get keywordwunsch(){return this.Keywords},set keywordwunsch(e){this.Keywords=e},WebPresenceNetPrice:"",get AF14129(){return this.WebPresenceNetPrice},set AF14129(e){this.WebPresenceNetPrice=e},get additional_field3(){return this.WebPresenceNetPrice},set additional_field3(e){this.WebPresenceNetPrice=e},BillingCompanyName:"",BillingSalutation:"",BillingFirstName:"",BillingLastName:"",BillingStreet:"",get BillingStreetAddress(){return this.BillingStreet},set BillingStreetAddress(e){this.BillingStreet=e},BillingHouseNumber:"",BillingAdditionalAddress:"",BillingPostcode:"",get BillingPostalCode(){return this.BillingPostcode},set BillingPostalCode(e){this.BillingPostcode=e},BillingCity:"",BillingCountry:"",get BillingCountryID(){return this.BillingCountry},set BillingCountryID(e){this.BillingCountry=e},OrderSystemNumber:"",CustomerNumber:"",get kundennummer(){return this.CustomerNumber},set kundennummer(e){this.CustomerNumber=e},get current_userid(){return this.CustomerNumber},set current_userid(e){this.CustomerNumber=e},InitialSetupFee:"",FollowingPayment:"",PaymentTermMonths:"",ContractTermMonths:"",CancellationPeriodMonths:"",PaymentMethod:"",PaymentStartDay:"",AccountHolder:"",IBAN:"",get province(){return this.IBAN},set province(e){this.IBAN=e},get account_no_iban(){return this.IBAN},set account_no_iban(e){this.IBAN=e},Bank:"",get state(){return this.BIC},set state(e){this.BIC=e},get bank_code_bic(){return this.BIC},set bank_code_bic(e){this.BIC=e},BIC:"",Analysis:[],Reseller:"",Cost:"",CleanNote:"",Subbiz:"",get ureseller(){return this.Subbiz},set ureseller(e){this.Subbiz=e},AgentData:null,get CountryCode(){let e=this.Country.toLowerCase();return["deutschland","germany","de"].some((t=>e.includes(t)))?"DE":["Ã¶sterreich","austria","at"].some((t=>e.includes(t)))?"AT":["schweiz","switzerland","ch"].some((t=>e.includes(t)))?"CH":""},set CountryCode(e){if("string"==typeof e){let t=e.toLowerCase();t.length&&(this.Country=["deutschland","germany","de"].some((e=>e.includes(t)||t.includes(e)))?"Deutschland":["Ã¶sterreich","austria","at"].some((e=>e.includes(t)||t.includes(e)))?"Ã–sterreich":["schweiz","switzerland","ch"].some((e=>e.includes(t)||t.includes(e)))?"Schweiz":"")}},get country_code(){return this.CountryCode},set country_code(e){return this.CountryCode=e,e},get uland(){return this.CountryCode},set uland(e){return this.CountryCode=e,e}};if(n&&"object"==typeof n&&(n.hasOwnProperty("OrderId")||n.hasOwnProperty("ufirma"))){if(n.hasOwnProperty("extrafields[AgentWP]")){const e={AgentName:n["extrafields[AgentWP]"].match(/(?<=\d\s).+?(?=\s\/)/gi),LeadID:n["extrafields[AgentWP]"].match(/(?<=^|\s)\d+?(?=\s)/gi),Location:n["extrafields[AgentWP]"].match(/(?<=\s)\w+?(?=$)/gi)};e.AgentName&&(n.AgentName=e.AgentName[e.AgentName.length-1]),e.LeadID&&(n.LeadID=e.LeadID[e.LeadID.length-1])}n.hasOwnProperty("extrafields[AgentWP]")&&(n.Website=n["extrafields[Webseite]"]);for(const e in n)if("object"==typeof n[e])for(const t in n[e])i.hasOwnProperty(t)&&(i[t]=n[e][t]);else i.hasOwnProperty(e)&&(i[e]=n[e])}else if(n||(n=document),e||(e=window.location.href),e.includes("dial24")||e.includes("tntdial")){const t={Firma:"CompanyName",Homepage:"Website",Branche:"Industry",Keywords:"Keywords","Analyse Link":"AnalysisLink",Tarife:"WebPresenceNetPrice",UStNummer:"VATId"};n.querySelectorAll(".trhead.afFrms").forEach((e=>{const n=e.querySelector("td:nth-child(3)").textContent.trim();let a=e.querySelector('input[name="alf_val"]');for(const r in t){"Tarife"==r&&(a=e.querySelector('select[name="alf_val"]'));let o="";if(r==n&&i.hasOwnProperty(t[r])&&a){if(o=a.value,"Tarife"==r){o=a.options[a.selectedIndex].value;let e=o.match(/(?<=^|\s|â‚¬|\D)(5|6|7|9)9(?=$|â‚¬|\s|\D|\.|,)/gi);e&&(o=e[0],i.Cost=o),o.includes("CHF")?i.Currency="CHF":i.Currency="Euro"}o.includes("@")&&!/\s/gi.test(o)&&(o=o.toLowerCase()),i[t[r]]=o}}}));const a=n.querySelectorAll("td.kopfstyle2");let r=/\d{4,5}(\s)?-(\s)?[a-zA-Z0-9\s_-]+(\s)?-(\s)?[a-zA-Z0-9\s_-]+/gi,o=/\d{7,11}(\s)?-(\s)?[a-zA-Z0-9\s_-]+/gi;a.forEach((e=>{let t=e.textContent;if(r.test(t)){let e=t.split("-");e&&3==e.length&&(i.AgentIDEnterprise=e[0].replace(/^\s+|\s+$/g,""),i.AgentName=e[2].replace(/^\s+|\s+$/g,""),i.AgentData||(i.AgentData={}),i.AgentData.agentid=i.AgentIDEnterprise,i.AgentData.name=i.AgentName,i.AgentData.location=list.dialerLocations[e[1].replace(/^\s+|\s+$/g,"")])}else if(o.test(t)){let e=t.split(" - ");e&&(i.LeadID=e[0].replace(/^\s+|\s+$/g))}}));for(const e in i){let t=n.querySelector(`input[name="${e}"]`);if("comments"==e&&(t=n.querySelector(`textarea[name="${e}"]`)),t){let n="textarea"!=t.tagName.toLowerCase()?t.value:t.textContent.length?t.textContent:t.value;n||(n=""),"address1"==e&&(n=correctStr(n)),n||(n=""),i[e]=n.replace(/[Ä°Ä±ÅžÅŸÃ‡Ã§ÄžÄŸ]/g,(e=>({"Ä°":"I","Ä±":"i","Åž":"S","ÅŸ":"s","Ã‡":"C","Ã§":"c","Äž":"G","ÄŸ":"g"}[e]))).replace(/^\s+|\s+$/g,"")}}if(e.includes("agent")){const e=n.querySelector("li.pull-right.hidden-phone a");e&&(i.AgentIDEnterprise=e.textContent.trim());const t=n.querySelector('[id="AF14129"]');t&&(i.WebPresenceNetPrice=t.value),i.WebPresenceNetPrice=i.WebPresenceNetPrice}if(e.includes("tntdial")){const e=n.querySelector('span[id="AgentMuteSpan"] a');if(e){let t=e.getAttribute("href");t&&t.length&&(i.AgentIDEnterprise=t.split("/")[1].split("-")[0],console.log("AgentIDEnterprise ",i.AgentIDEnterprise))}const t=n.querySelector('[id="AF14129"]');t&&(i.WebPresenceNetPrice=t.value),i.WebPresenceNetPrice=i.WebPresenceNetPrice}}else if(/webdial\.|(dial\.(aadvanto|spectario|movido-media)\.(de|com|net))|stg-dialer/gi.test(e)){const t={Firma:"CompanyName",Homepage:"Website",Branche:"Industry",Keywords:"Keywords","Analyse Link":"AnalysisLink",Tarife:"WebPresenceNetPrice",UStNummer:"VATId"};n.querySelectorAll(".trhead.afFrms").forEach((e=>{const n=e.querySelector("td:nth-child(3)").textContent.trim();let a=e.querySelector('input[name="additional_field3"]');//! TODO: Price Netto ID may change in the new dialer
    for(const r in t){"Tarife"==r&&(a=e.querySelector('select[name="additional_field3"]'));//! TODO: Price Netto ID may change in the new dialer
    let o="";if(r==n&&i.hasOwnProperty(t[r])&&a){if(o=a.value,"Tarife"==r){o=a.options[a.selectedIndex].value;let e=o.match(/(?<=^|\s|â‚¬|\D)(5|6|7|9)9(?=$|â‚¬|\s|\D|\.|,)/gi);e&&(o=e[0],i.Cost=o),o.includes("CHF")?i.Currency="CHF":i.Currency="Euro"}o.includes("@")&&!/\s/gi.test(o)&&(o=o.toLowerCase()),i[t[r]]=o}}}));const a=n.querySelectorAll("td.kopfstyle2");let r=/\d{4,5}(\s)?-(\s)?[a-zA-Z0-9\s_-]+(\s)?-(\s)?[a-zA-Z0-9\s_-]+/gi,o=/\d{7,11}(\s)?-(\s)?[a-zA-Z0-9\s_-]+/gi;a.forEach((e=>{let t=e.textContent;if(r.test(t)){let e=t.split("-");e&&3==e.length&&(i.AgentIDEnterprise=e[0].replace(/^\s+|\s+$/g,""),i.AgentName=e[2].replace(/^\s+|\s+$/g,""),i.AgentData||(i.AgentData={}),i.AgentData.agentid=i.AgentIDEnterprise,i.AgentData.name=i.AgentName,i.AgentData.location=list.dialerLocations[e[1].replace(/^\s+|\s+$/g,"")])}else if(o.test(t)){let e=t.split(" - ");e&&(i.LeadID=e[0].replace(/^\s+|\s+$/g))}}));for(const e in i){let t=n.querySelector(`input[name="${e}"]`);if("comments"==e&&(t=n.querySelector(`textarea[name="${e}"]`)),t){let n="textarea"!=t.tagName.toLowerCase()?t.value:t.textContent.length?t.textContent:t.value;n||(n=""),"address2"==e&&(n=correctStr(n)),//! TODO: address2 (Street) may change in the new dialer
    n||(n=""),i[e]=n.replace(/[Ä°Ä±ÅžÅŸÃ‡Ã§ÄžÄŸ]/g,(e=>({"Ä°":"I","Ä±":"i","Åž":"S","ÅŸ":"s","Ã‡":"C","Ã§":"c","Äž":"G","ÄŸ":"g"}[e]))).replace(/^\s+|\s+$/g,"")}}if(e.includes("agent")){const e=n.querySelector(".nav-item.dropdown .dropdown-menu.dropdown-menu-lg.dropdown-menu-right dropdown-item .float-right.text-muted.text-sm");e&&(i.AgentIDEnterprise=e.textContent.trim());const t=n.querySelector('[id="additional_field3"]');//! TODO: Price Netto ID may change in the new dialer
    t&&(i.WebPresenceNetPrice=t.value),i.WebPresenceNetPrice=i.WebPresenceNetPrice}if(/^[0-9]/gi.test(i.Street)){let e=i.Street;i.Street=i.HouseNumber,i.HouseNumber=e}}else if(e.includes("agent.")&&e.includes("dashboard/customers")||e.includes(".movido.cloud/app/customers/details/")){let t=e.match(/(?<=customers\/details\/)\d{4,6}(?=\/)/gi);t&&(i.CustomerNumber=t[0]);for(const e in i){const t=n.querySelector(`[formcontrolname="${e}"]`);if(t){let n=t.value;n||(n="");if("combobox"===t.getAttribute("role")){let a,r=t.querySelector("span.mat-select-value-text");if(r&&(a=r.textContent.trim(),n=a),n||(n=""),"Currency"==e)n=n.includes("CHF")?"CHF":"Euro";else if("Salutation"==e)n=/((?<=\s|^)male)|her/gi.test(n)?"Male":"Female";else if("WebPresenceNetPrice"==e){let e=n.match(/(?<=^|\s|â‚¬|\D)(12|5|6|7|9)9(?=$|â‚¬|\s|\D|\.|,)/gi);e&&(i.Currency=/chf/gi.test(n)?"CHF":/â‚¬|eur/gi.test(n)?"Euro":"",n=e[0],i.Cost=n)}}else"Street"==e&&(n=correctStr(n));n||(n=""),n.includes("@")&&!/\s/gi.test(n)&&(n=n.toLowerCase()),i[e]=n.replace(/[Ä°Ä±ÅžÅŸÃ‡Ã§ÄžÄŸ]/g,(e=>({"Ä°":"I","Ä±":"i","Åž":"S","ÅŸ":"s","Ã‡":"C","Ã§":"c","Äž":"G","ÄŸ":"g"}[e]))).replace(/^\s+|\s+$/g,"")}}}else if(e.includes("/inagents/index.php")){let t,a=e.match(/(?<=((user\&id)|(userid))\=)\d{4,6}(?=$|&|\n)/gi);a&&(i.CustomerNumber=a[0]);for(const e in i)if(t=n.querySelector(`input[name="${e}"]`),t||(t=n.querySelector(`textarea[name="${e}"]`)),t||(t=n.querySelector(`select[name="${e}"]`)),t){let n="textarea"!=t.tagName.toLowerCase()?t.value:t.textContent.length?t.textContent:t.value;"maennlich"==n?n="Male":"weiblich"==n&&(n="Female"),n.includes("@")&&!/\s/gi.test(n)&&(n=n.toLowerCase()),i[e]=n}if(t=n.querySelector('input[name="extrafields[Webseite]"]'),t&&(i.Website=t.value),t=n.querySelector('input[name="extrafields[AgentWP]"]'),t){let e=t.value.match(/\d{7,9}/gi),n=t.value.match(/(?<=\d{7}\s)[a-zA-Z\sÃ¼ÃœÃ¶Ã–Ã¤Ã„Ä±IÄ°-]{5,32}(?=\s\/|$|\s$)/gi);e&&(i.LeadID=e[e.length-1]),n&&(i.AgentName=n[n.length-1])}}if(i.Country&&i.Country.length||(i.TelephoneNumberCode.endsWith("41")?i.CountryCode="CH":i.TelephoneNumberCode.endsWith("43")?i.CountryCode="AT":i.TelephoneNumberCode.endsWith("49")&&(i.CountryCode="DE")),i.MobilePhoneNumberCode&&i.MobilePhoneNumberCode.length||!i.MobileNumber.length||(i.MobileNumber.startsWith("01")&&(i.MobileNumber=i.MobileNumber.substring(1)),i.MobilePhoneNumberCode=i.TelephoneNumberCode),i.Currency||!i.Currency||i.Currency.length||(/â‚¬|eur/gi.test(i.WebPresenceNetPrice)?i.Currency="â‚¬":/chf/gi.test(i.WebPresenceNetPrice)&&(i.Currency="CHF")),i.WebPresenceNetPrice=i.WebPresenceNetPrice.replace(/[^\d\.]/gi,""),i.WebPresenceNetPrice.includes(".")&&(i.WebPresenceNetPrice=i.WebPresenceNetPrice.split(".")[0]),(/^de$/i.test(i.CountryCode)||/chf/gi.test(i.Currency))&&/(?<=^|0)41(?=$|0)/gi.test(i.TelephoneNumberCode+i.MobilePhoneNumberCode)&&(i.PostalCode.length<5||i.PostalCode.startsWith("0"))&&(i.Country="Schweiz",i.PostalCode=i.PostalCode.replace(/^0(?=\d{4})/,"")),/^ch$/i.test(i.CountryCode)&&(i.Street=i.Street.replace(/ÃŸ/gi,"ss"),i.BillingStreet=i.BillingStreet.replace(/ÃŸ/gi,"ss"),i.PostalCode.length>4&&i.PostalCode.startsWith("0")&&(i.PostalCode=i.PostalCode.substring(1))),i.AgentIDEnterprise=i.AgentIDEnterprise.replace(/\D/g,"").replace(/^(6)?(3)?(0)?(?=\d\d\d\d)/gm,""),i.CompanyName=i.CompanyName.replace(/gmbh/gi,"GmbH").replace(/\s+/gi," "),i.Reseller=e.includes("aadvanto")?"Aadvanto":e.includes("movido")?"Movido":e.includes("spectario")?"Spectario":"",i.Subcontractor=i.Reseller.includes("Aadvanto")?"United Call":i.Reseller.includes("Movido")?"Movido Media":i.Reseller.includes("Spectario")?"Spectario":"",console.log("Getagentdata order",i),i.AgentData||(i.AgentData=getAgentData(i.AgentIDEnterprise,i.AgentName)),i.AgentData||(i.AgentData=await getAgentDataFromAgentsystem(i.AgentName,i.AgentIDEnterprise),console.log("Got agentdata from agentsystem:",i.AgentData)),i.AgentData||(console.log("No Agentdata. Order:",i,`Reseller: '${i.Reseller}'`),"Aadvanto"!=i.Reseller&&"Spectario"!=i.Reseller||(i.AgentData={agentid:i.AgentIDEnterprise,name:i.AgentName,location:null},console.log("ORDER",i))),i["extrafields[AgentWP]"]=`${i.LeadID} ${i.AgentName}${i.AgentData?" / "+i.AgentData.location:""}`,i.AgentData&&(i.Reseller&&i.Reseller.length||(i.Reseller="Izmir"==i.AgentData.location?"Aadvanto":"Kirsehir"==i.AgentData.location?"Spectario":"Movido"),i.Subcontractor&&i.Subcontractor.length||(i.Subcontractor="Izmir"==i.AgentData.location?"United Call":"Kirsehir"==i.AgentData.location?"Spectario":"Movido"),i.Subbiz=list.subbiz[i.Reseller.toLowerCase()][(i.AgentData.location??"").toLowerCase()]),!i.LastName.length&&i.FirstName.includes(" ")){let e=i.FirstName.split(" ");e&&(i.LastName=e.pop(),i.FirstName=e.join(" "))}i.FirstName.toLowerCase().endsWith(" "+i.LastName.toLowerCase())&&(i.FirstName=i.FirstName.substring(0,i.FirstName.length-i.LastName.length-1)),i.FirstName=i.FirstName.charAt(0).toUpperCase()+i.FirstName.substring(1).toLowerCase(),i.LastName=i.LastName.charAt(0).toUpperCase()+i.LastName.substring(1).toLowerCase();let a=i.FirstName.match(/(?<=^|\s|-)[a-z]/g);if(a&&(i.FirstName=i.FirstName.replace(/(?<=^|\s|-)[a-z]/g,a[0].toUpperCase())),a=i.LastName.match(/(?<=^|\s|-)[a-z]/g),a&&(i.LastName=i.LastName.replace(/(?<=^|\s|-)[a-z]/g,a[0].toUpperCase())),i.Email=i.Email.toLowerCase(),!i.Cost.length){let e=i.Notes.match(/(?<=^|\s|â‚¬|\D)(\d{1,2})9(?=$|â‚¬|\s|\D|\.|,)/gi);e&&(i.Cost=e[0])}i.Telephone=i.Telephone.replace(/\D/g,""),i.MobileNumber=i.MobileNumber.replace(/\D/g,"");let r=i.AnalysisLink+" - "+i.CompanyName+" - "+i.Notes;i.Analysis=[...new Set(r.match(list.regex.analysis))];let o=[];for(var s=0;s<i.Analysis.length;s++){if(i.Analysis[s].toLowerCase().includes("recheck")||i.Analysis[s].toLowerCase().includes("autostart=true")||(i.Analysis[s]+="&autostart=true"),!i.Analysis[s])continue;let e="";try{e=new URL(i.Analysis[s])}catch(e){continue}finally{const t=new URLSearchParams(e.search);let n={url:e.toString().replace(/(movido-media\.at\/mein-test)|(movido-media\.de\/web-presence-analysis)/gi,"movido-media.de/meinwpa"),name:t.get("ubname")??"",street:t.get("ubstreet")??"",country:t.get("ubcountry")??"",city:t.get("ubcity")??"",zip:t.get("ubzip")??"",recheckid:t.get("ubrecheckid")??"",rechecktoken:t.get("ubrechecktoken")??""};if(n.recheckid.length&&n.rechecktoken.length&&!n.name.length&&!n.street.length&&!n.zip.length&&"undefined"!=typeof uberall){let e=await uberall.getRecheckInfo({public_key:void 0,recheckid:n.recheckid,rechecktoken:n.rechecktoken});e&&(n.name=e.name,n.street=e.street+(e.streetNo.length?" "+e.streetNo:""),n.zip=e.zip,n.city=e.city,n.country=e.country.toUpperCase()),n.url=n.url.split("?")[0]+`?ubcountry=${encodeURIComponent(n.country)}&ubname=${encodeURIComponent(n.name)}&ubstreet=${encodeURIComponent(n.street)}&ubzip=${encodeURIComponent(n.zip)}&ubcity=${encodeURIComponent(n.city)}`}n.zip=("DE"==n.country&&n.zip.length<5?"0":"")+n.zip.replace(/\D/,""),n.name=n.name.replace(/\+{3}/gi," + ").replace(/(?<!\s)\+(?!\s)/gi," ").replace(/\s\s+/g," ").replace(/^(\s+|:)+|(\s+|:)+$/g,""),0==i.CompanyName.length&&(i.CompanyName=n.name??""),n.street=n.street.replace(/\+{3}/gi," + ").replace(/(?<!\s)\+(?!\s)/gi," ").replace(/\s\s+/g," ").replace(/^(\s+|:)+|(\s+|:)+$/g,""),-1==o.findIndex((e=>e.name.toLowerCase()===n.name.toLowerCase()&&e.street.toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss")===n.street.toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss")&&e.country.toLowerCase()===n.country.toLowerCase()&&e.zip===n.zip&&e.recheckid===n.recheckid&&e.rechecktoken===n.rechecktoken))&&o.push(n)}}if(i.Analysis=o,(i.CompanyName.toLowerCase().includes("aadvanto")||i.CompanyName.toLowerCase().includes("movido")||i.CompanyName.toLowerCase().includes("spectario"))&&i.Analysis.length>0&&(i.CompanyName=i.Analysis[0].name),i.LeadID=i.LeadID.replace(/\D/g,""),i.Keywords.length<2&&(i.Keywords=i.Industry),i.VATId=i.VATId.length>0?i.CountryCode+("AT"==i.CountryCode?"U":"")+i.VATId.replace(/\D/g,""):"",i.VATId.length<4&&(i.VATId=""),i.VATId.length>6&&i.VATId.startsWith("AT")){let e=await check.vat(i.VATId);if(e&&(e.valid||(e=await check.vat(i.VATId),e.valid||(i.Notes+=(i.Notes.length?" - ":"")+`ATU nr erfragen bitte, die angegebene "${i.VATId}" kommt ungÃ¼ltig raus`,i.VATId="")),e.valid&&e.vat_number&&i.VATId.endsWith(e.vat_number))){i.VATdata=e;let t=(e.address.split(/\n/)[0].match(list.regex.housenumber)??[""])[0];console.log("houseno:",t,"vataddress:",e.address);let n=e.address.split(/\n/)[0].replace(t,"").replace(/^\s+|\s+$/gi,""),a=e.address.includes("DE-")?"DE":"AT",r=e.address.split(a+"-")[1].match(/^\d{4,5}(?=\s)/gi)[0],o=e.address.split(r+" ")[1],s=e.name;(!s.toLowerCase().replace(/[^a-z]/g,"").includes(i.CompanyName.toLowerCase().replace(/[^a-z]/g,""))||s.includes(i.FirstName.toLowerCase().replace(/[^a-z]/g,""))&&s.includes(i.LastName.toLowerCase().replace(/[^a-z]/g,"")))&&(i.BillingCompanyName=s,i.BillingGender=i.Gender),i.Street.toLowerCase().replace(/[^a-z]/g,"").includes(n.toLowerCase().replace(/[^a-z]/g,""))&&i.HouseNumber.toLowerCase().includes(t.toLowerCase())||(i.BillingStreet=n,i.BillingHouseNumber=t,i.BillingCity=o,i.BillingPostalCode=r,i.BillingCountryID=a)}}i.TelephoneCode.startsWith("04")&&(i.TelephoneCode=i.TelephoneCode.replace("04","004")),i.MobilePhoneNumberCode.startsWith("04")&&(i.MobilePhoneNumberCode=i.MobilePhoneNumberCode.replace("04","004"));let l=[await sepNo(i.TelephoneCode+" "+i.TelephoneNumber),await sepNo(i.MobilePhoneNumberCode+" "+i.MobilePhoneNumber)];if(l.length>1&&l[0].no===l[1].no&&(l[1]={area:"",no:"",mobile:!1}),1==l[0].mobile&&(0==l[1].mobile||null==l[1].mobile)){let e=l[0];l[0]=l[1],l[1]=e}if(i.MobilePhoneNumberCode=l[1].area,i.MobilePhoneNumber=l[1].no,i.TelephoneNumberCode=l[0].area,i.TelephoneNumber=l[0].no,i.LeadID.startsWith("63")&&i.LeadID.length<=7&&i.AgentIDEnterprise.length>7&&!i.AgentIDEnterprise.startsWith("63")){let e=i.LeadID;i.LeadID=i.AgentIDEnterprise,i.AgentIDEnterprise=e}i.AgentIDEnterprise=i.AgentIDEnterprise.replace(/\D/g,"").replace(/^(6)?(3)?(0)?/gm,""),i.Website.includes("@")&&(i.Email.length>3?i.Email==i.Website&&(i.Website=""):(i.Email=i.Website,i.Website="")),i.CleanNote=i.FreeText;let d="";i.CleanNote.includes("AP:")||i.CleanNote.includes("A.P.:")||i.CleanNote.includes("Ansp.")||i.CleanNote.includes("A.P.")||i.CleanNote.includes("Ansprechpartner:")||i.CleanNote.includes("AP ")||i.CleanNote.includes(i.ContactPerson)||i.CleanNote.includes(i.FirstName)||i.CleanNote.includes(i.LastName)||(i.CleanNote.length>3&&(d=" - "),i.CleanNote+=d+"AP: "+i.ContactPerson),!("AT"==i.CountryCode&&i.VATId.length<6)||i.CleanNote.includes("ATU")||i.CleanNote.includes("Atu")||i.CleanNote.toLowerCase().includes(" atu")||i.CleanNote.toLowerCase().includes("atu ")||(i.CleanNote.length>2&&(i.CleanNote+=" - "),i.CleanNote+="ATU nr erfragen bitte"),"Movido"==i.Reseller||"Spectario"==i.Reseller?i.CleanNote=i.CleanNote.replace(list.regex.analysisrm,"").replace(list.regex.costrm,""):"Aadvanto"==i.Reseller&&(i.CleanNote=i.CleanNote.replace(list.regex.analysisrm,"")),i.CleanNote=i.CleanNote.replace(/\n{2,}/gim,"\n").replace(/^\n+|\n+$/gi,"");let c=i.Notes.match(list.regex.cost);if(c&&c.length>0&&(c[0]=c[0].replace(/\D/g,""),i.Cost.includes(c[0])||(i.CostNotes=c[0])),!i.HouseNumber.length&&list.regex.housenumber.test(i.Street)&&(i.HouseNumber=i.Street.match(list.regex.housenumber)[0],i.Street=i.Street.replace(i.HouseNumber,"").replace(/^\s+|\s+$/gi,"")),i.HouseNumber+=(/^[0-9]/.test(i.AdditionalAddress)?"/":"")+i.AdditionalAddress.replace(/^\s+|\s+$/gi,""),!i.Website.includes(".")||i.Website.endsWith("."))i.Website="";else if(/Ã¤|Ã¶|Ã¼/gi.test(i.Website)){i.Website.startsWith("http")||(i.Website="https://"+i.Website);let e=new URL(i.Website);i.Website=e.toString()}i.Postcode=i.Postcode.replace(/\D/g,""),i.City=i.City.replace(/St\.(\s)?/,"Sankt ").replace(/\d/gi,"").replace(/(^(\s+|,|\.|-|:))?((\s+|,|\.|-|:)$)?/gi,""),i.Email=i.Email.toLowerCase().replace("googlemail","gmail").replace(/(icloud)\.(at|de)/gi,"icloud.com").replace(/(gmail)\.(at|de)/gi,"gmail.com");let p=i.Email.split("@");if(p&&/Ã¤|Ã¶|Ã¼/gi.test(p[1])){let e=new URL("https://"+p[1]);p[1]=e.toString(),i.Email=`${p[0]}@${p[1].replace(/(http(s)?:)|\//gi,"")}`}if(i.Postcode.length<5&&"DE"==i.CountryCode&&!/4(1|3)/.test(i.TelephoneNumberCode)&&!/4(1|3)/.test(i.MobilePhoneNumberCode)&&(i.Postcode="0"+i.Postcode),["aadvanto","movido","spectario"].some((e=>i.CompanyName.toLowerCase().includes(e)))&&i.CompanyName.toLowerCase().includes("ubname")){let e=uberall.parseAnalysisLink(i.CompanyName);e&&e.name&&(i.CompanyName=e.name)}return customersCache.add(i),t&&t(i),i}export function getOrder(e=void 0,t=void 0,n=void 0,i=void 0){if(!t)return getOrderBG(e,n,i);chrome.scripting.executeScript({target:{tabId:t},function:getOrderBG,args:[e]})}export const steroid={injectHtml:function(){let e=document.getElementById("steroid-container");e&&fetch(chrome.runtime.getURL("./html/steroid.html")).then((e=>e.text())).then((t=>{e.outerHTML=t;const n=document.getElementById("ubcheckbutton");n&&(n.removeEventListener("click",(()=>{})),n.addEventListener("click",(()=>{const e=document.getElementById("ubcheckname"),t=document.getElementById("ubcheckaddress"),n=document.getElementById("ubcheckzip");if(e&&t&&n){let i="DE";4==n.value.length&&(i="AT"),steroid.ubcheck({name:e.value,street:t.value,zip:n.value,country:i})}})))}))},ubcheck:function({name:e="",street:t=e,city:n="",zip:i="",phone:a="",country:r,recheckid:o=null,rechecktoken:s=null,autoDownloadPdf:l=!0,skip:d}){let c=o&&s;r||(r="DE"),steroid.cleanWpaDiv().then((()=>{if(i&&i.length>3&&e.length>1||o&&s){let u="movido",m=list.base[u].public_key;chrome.storage.local.get(["reseller"],(function(e){u=e.reseller,m=list.base[u]?list.base[u].public_key:uberall.getApiKey()})),d||(d=["NAVMII","GO_YELLOW","WO_GIBTS_WAS","GOOGLE_ASSISTANT","GOOGLE_MAPS","FACEBOOK","I_GLOBAL","TOMTOM","INSTAGRAM","MICROSOFT_CORTANA","DIALO","KOOMIO","INFO_IS_INFO","FIND_OPEN","BRANCHENBUCH_DEUTSCHLAND","MARKTPLATZ_MITTELSTAND","NOKIA_HERE","UBER","UNTERNEHMENSAUSKUNFT","AUSKUNFT","WAZE","JELLOO","INFOBEL","STADTBRANCHENBUCH","APPLE_MAPS","YELLBO","WHERE_TO","FOURSQUARE","TRIP_ADVISOR","ALEXA","SIRI","NEXT_DOOR","HUAWEI","YELP","BROWNBOOK","YALWA"]);var p=!1;steroid.prepareWpaEntryPos(uberall.directoryType),settings&&"true"==settings.useRandomApiKeys.steroid&&(m=void 0),uberall.fullCheck({name:e,street:t,city:n,zip:i,country:r,phone:a,key:m,id:o,token:s,callback:function(e){if(e){if(s||(s=e.token),p)return 0;if(s!=e.token)return 0;steroid.addWpaEntry({data:e}),e.alreadyManaged&&(p=!0)}},skip:d}).then((t=>{console.log("[Agentsystem.js] Listing check finished completely. Data:",t),t&&(t.errorCode||uberall.pdfExport(s).then((t=>{t&&downloadPdf({data:t,name:e,recheckid:o,zip:i,isrecheck:c,autoDownloadPdf:l})})))}))}}))},createMailIndex:function(e,t,n,i=!1){let a='<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset="></head><body><p>Sehr geehrte'+(t.startsWith("H")||t.startsWith("M")?"r Herr":" Frau")+" "+e+",<br><br>anbei senden wir Ihnen Ihr WebprÃ¤senz Analyseergebnis"+(i?" sowie den SEO Check inklusive SEO Bewertungsergebnis":"")+' als PDF Datei zur Kenntnisnahme.<br><br>Der zustÃ¤ndige Digital Solution Manager wird sich kurzfristig bei Ihnen telefonisch melden, um mit Ihnen die Ergebnisse zu besprechen.<br></p><div class="moz-signature">--<br>\x3c!--[if gte mso 9]><xml><o:officedocumentsettings><o:allowpng><o:pixelsperinch>96</o:pixelsperinch></o:officedocumentsettings></xml><![endif]--\x3e<meta content="text/html; charset=" http-equiv="Content-Type"><meta content="width=device-width" name="viewport">\x3c!--[if !mso]>\x3c!--\x3e<meta content="IE=edge" http-equiv="X-UA-Compatible">\x3c!--<![endif]--\x3e<title></title>\x3c!--[if !mso]>\x3c!--\x3e\x3c!--<![endif]--\x3e<style type="text/css">body{margin:0;padding:0}table,td,tr{vertical-align:top;border-collapse:collapse}*{line-height:inherit}a[x-apple-data-detectors=true]{color:inherit!important;text-decoration:none!important}</style><style id="media-query" type="text/css"></style><style id="icon-media-query" type="text/css"></style>\x3c!--[if IE]><div class="ie-browser"><![endif]--\x3e<table class="nl-container" role="presentation" style="table-layout:fixed;vertical-align:top;min-width:320px;border-spacing:0;border-collapse:collapse;mso-table-lspace:0;mso-table-rspace:0;background-color:#fff;width:100%" valign="top" width="100%" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF"><tbody><tr style="vertical-align:top" valign="top"><td style="word-break:break-word;vertical-align:top" valign="top">\x3c!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td align="center" style="background-color:#fff"><![endif]--\x3e<div style=""><div class="block-grid" style="min-width:320px;max-width:500px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div style="border-collapse:collapse;display:table;width:100%">\x3c!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style=""><tr><td align="left"><table cellpadding="0" cellspacing="0" border="0" style="width:500px"><tr class="layout-full-width" style="background-color:transparent"><![endif]--\x3e\x3c!--[if (mso)|(IE)]><td align="center" width="500" style="width:500px;border-top:0 solid transparent;border-left:0 solid transparent;border-bottom:0 solid transparent;border-right:0 solid transparent" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:0;padding-left:0;padding-top:5px;padding-bottom:5px"><![endif]--\x3e<div class="col num12" style="min-width:320px;max-width:500px;display:table-cell;vertical-align:top;width:500px"><div class="col_cont" style="width:100%!important">\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e<div style="border-top:0 solid transparent;border-left:0 solid transparent;border-bottom:0 solid transparent;border-right:0 solid transparent;padding-top:5px;padding-bottom:5px;padding-right:0;padding-left:0">\x3c!--<![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:10px;padding-left:0;padding-top:10px;padding-bottom:10px;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:0"><div class="txtTinyMce-wrapper" style="font-size:14px;line-height:1.2;color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:17px"><p style="margin:0;line-height:1.2;word-break:break-word;mso-line-height-alt:17px;margin-top:0;margin-bottom:0">Mit freundlichen GrÃ¼ÃŸen | Best regards</p></div></div>\x3c!--[if mso]><![endif]--\x3e\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e</div>\x3c!--<![endif]--\x3e</div></div>\x3c!--[if (mso)|(IE)]><![endif]--\x3e\x3c!--[if (mso)|(IE)]><![endif]--\x3e</div></div></div><div style=""><div class="block-grid two-up" style="min-width:320px;max-width:500px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div style="border-collapse:collapse;display:table;width:100%">\x3c!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style=""><tr><td align="left"><table cellpadding="0" cellspacing="0" border="0" style="width:500px"><tr class="layout-full-width" style="background-color:transparent"><![endif]--\x3e\x3c!--[if (mso)|(IE)]><td align="center" width="125" style="width:125px;border-top:0 solid transparent;border-left:0 solid #8d8d8d;border-bottom:0 solid transparent;border-right:0 solid #8d8d8d" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:10px;padding-left:0;padding-top:5px;padding-bottom:5px"><![endif]--\x3e<div class="col num3" style="display:table-cell;vertical-align:top;max-width:320px;min-width:123px;width:125px"><div class="col_cont" style="width:100%!important">\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e<div style="border-top:0 solid transparent;border-left:0 solid #8d8d8d;border-bottom:0 solid transparent;border-right:0 solid #8d8d8d;padding-top:5px;padding-bottom:5px;padding-right:10px;padding-left:0">\x3c!--<![endif]--\x3e<div class="img-container center autowidth" style="padding-right:0;padding-left:0" align="center">\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr style="line-height:0">\t\t<td style="padding-right:0;padding-left:0" align="center"><![endif]--\x3e<img class="center autowidth" src="https://cdn.movido.cloud/public/movido/logo/square.png" style="text-decoration:none;-ms-interpolation-mode:bicubic;height:auto;border:0;width:115px;max-width:100%;display:block" width="115" border="0" align="middle">\x3c!--[if mso]><![endif]--\x3e</div>\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e</div>\x3c!--<![endif]--\x3e</div></div>\x3c!--[if (mso)|(IE)]><![endif]--\x3e\x3c!--[if (mso)|(IE)]><td align="center" width="375" style="width:375px;border-top:0 solid transparent;border-left:5px solid #8d8d8d;border-bottom:0 solid transparent;border-right:0 solid transparent" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:0;padding-left:10px;padding-top:5px;padding-bottom:5px"><![endif]--\x3e<div class="col num9" style="display:table-cell;vertical-align:top;max-width:320px;min-width:369px;width:368px"><div class="col_cont" style="width:100%!important">\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e<div style="border-top:0 solid transparent;border-left:5px solid #8d8d8d;border-bottom:0 solid transparent;border-right:0 solid transparent;padding-top:5px;padding-bottom:5px;padding-right:0;padding-left:10px">\x3c!--<![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:5px;padding-left:5px;padding-top:5px;padding-bottom:0;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#8cc73f;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:0;padding-right:5px;padding-bottom:0;padding-left:5px"><div class="txtTinyMce-wrapper" style="font-size:14px;line-height:1.2;color:#8cc73f;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:17px"><p style="margin:0;font-size:14px;line-height:1.2;word-break:break-word;mso-line-height-alt:17px;margin-top:0;margin-bottom:0"><strong><span style="font-size:16px">Anna Bergmann</span></strong></p></div></div>\x3c!--[if mso]><![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:5px;padding-left:5px;padding-top:0;padding-bottom:5px;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:0;padding-right:5px;padding-bottom:5px;padding-left:5px"><div class="txtTinyMce-wrapper" style="font-size:12px;line-height:1.2;color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:14px"><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0"><strong>Customer Success Manager</strong></p><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0"><a href="mailto:service@'+n+'" rel="noopener noreferrer" style="color:#0068a5" target="_blank">service@'+n+'</a></p><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0">Kostenlose-Hotline DE:<a href="tel:0800-0805190" rel="noopener noreferrer" style="color:#0068a5" target="_blank">0800-0805190</a></p><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0">Kostenlose-Hotline AT/CH:<a href="tel:0800-080519" rel="noopener noreferrer" style="color:#0068a5" target="_blank">0800-080519</a></p></div></div>\x3c!--[if mso]><![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:5px;padding-left:5px;padding-top:5px;padding-bottom:5px;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px"><div class="txtTinyMce-wrapper" style="font-size:12px;line-height:1.2;color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:14px"><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0"><strong>Movido Media Verlag GmbH</strong></p><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0">Steinstrasse 2 | 40212 DÃ¼sseldorf</p><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0"><a href="www.movido-media.de" rel="noopener noreferrer" style="color:#0068a5" target="_blank">www.movido-media.de</a></p></div></div>\x3c!--[if mso]><![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:5px;padding-left:5px;padding-top:5px;padding-bottom:5px;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px"><div class="txtTinyMce-wrapper" style="font-size:12px;line-height:1.2;color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:14px"><p style="margin:0;font-size:12px;line-height:1.2;word-break:break-word;mso-line-height-alt:14px;margin-top:0;margin-bottom:0">GeschÃ¤ftsfÃ¼hrer: Oliver Griebsch<br>Amtsgericht DÃ¼sseldorf, HRB 80949<br>Finanzamt DÃ¼sseldorf-Mitte<br>USt-Id.: DE313542688</p></div></div>\x3c!--[if mso]><![endif]--\x3e\t\t\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e</div>\x3c!--<![endif]--\x3e</div></div>\x3c!--[if (mso)|(IE)]><![endif]--\x3e\x3c!--[if (mso)|(IE)]><![endif]--\x3e</div></div></div><div style=""><div class="block-grid" style="min-width:320px;max-width:500px;overflow-wrap:break-word;word-wrap:break-word;word-break:break-word;background-color:transparent"><div style="border-collapse:collapse;display:table;width:100%">\x3c!--[if (mso)|(IE)]><table width="100%" cellpadding="0" cellspacing="0" border="0" style=""><tr><td align="left"><table cellpadding="0" cellspacing="0" border="0" style="width:500px"><tr class="layout-full-width" style="background-color:transparent"><![endif]--\x3e\x3c!--[if (mso)|(IE)]><td align="center" width="500" style="width:500px;border-top:0 solid transparent;border-left:0 solid transparent;border-bottom:0 solid transparent;border-right:0 solid transparent" valign="top"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:0;padding-left:0;padding-top:5px;padding-bottom:5px"><![endif]--\x3e<div class="col num12" style="min-width:320px;max-width:500px;display:table-cell;vertical-align:top;width:500px"><div class="col_cont" style="width:100%!important">\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e<div style="border-top:0 solid transparent;border-left:0 solid transparent;border-bottom:0 solid transparent;border-right:0 solid transparent;padding-top:5px;padding-bottom:5px;padding-right:0;padding-left:0">\x3c!--<![endif]--\x3e\x3c!--[if mso]><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td style="padding-right:10px;padding-left:10px;padding-top:10px;padding-bottom:10px;font-family:Arial,sans-serif"><![endif]--\x3e<div style="color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="txtTinyMce-wrapper" style="font-size:14px;line-height:1.2;color:#555;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;mso-line-height-alt:17px"><p style="margin:0;font-size:11px;line-height:1.2;word-break:break-word;mso-line-height-alt:13px;margin-top:0;margin-bottom:0"><span style="font-size:11px"><strong>Hinweis:</strong>Der Inhalt dieser E-Mail ist vertraulich und ausschlieÃŸlich fÃ¼r den bezeichneten Adressaten bestimmt. Wenn Sie nicht der vorgesehene Adressat dieser E-Mail sein sollten, setzen Sie sich bitte mit dem Absender per E-Mail oder unter der angegebenen Telefonnummer in Verbindung und vernichten Sie diese E-Mail auf Ihren Speichermedien.</span><br><br><span style="font-size:11px"><strong>Notice:</strong>The information contained in this e-mail is confidential. It is intended solely for the addressee named above. If you are not the intended recipient, please notify the sender immediately and destroy this message on any media of yours.</span></p></div></div>\x3c!--[if mso]><![endif]--\x3e\x3c!--[if (!mso)&(!IE)]>\x3c!--\x3e</div>\x3c!--<![endif]--\x3e</div></div>\x3c!--[if (mso)|(IE)]><![endif]--\x3e\x3c!--[if (mso)|(IE)]><![endif]--\x3e</div></div></div>\x3c!--[if (mso)|(IE)]><![endif]--\x3e</td></tr></tbody></table>\x3c!--[if (IE)]><![endif]--\x3e</div></body></html>';return n.includes("pectario")?a='<!DOCTYPE html><html> <head> <meta http-equiv="content-type" content="text/html; charset="> </head> <body> <p>Sehr geehrte'+(t.startsWith("H")||t.startsWith("M")?"r Herr":" Frau")+" "+e+',<br><br>anbei senden wir Ihnen Ihr WebprÃ¤senz Analyseergebnis als PDF Datei zur Kenntnisnahme. <br><br>Der zustÃ¤ndige Digital Solution Manager wird sich kurzfristig bei Ihnen telefonisch melden, um mit Ihnen die Ergebnisse zu besprechen. <br><br>Bei Fragen stehen wir ihnen unter folgender E-Mail Adresse zur VerfÃ¼gung: <a moz-do-not-send="true" href="mailto:service@spectario.com">service@spectario.com</a> oder telefonisch unter: 030-439 737 360. </p><div class="moz-signature">-- <br><meta content="text/html; charset=" http-equiv="Content-Type"> <meta content="width=device-width" name="viewport"> <meta content="IE=edge" http-equiv="X-UA-Compatible"> <title></title> <style type="text/css">body{margin: 0;padding: 0;}table,td,tr{vertical-align: top;border-collapse: collapse;}*{line-height: inherit;}a[x-apple-data-detectors=true]{color: inherit !important;text-decoration: none !important;}</style> <style id="media-query" type="text/css"></style> <style id="icon-media-query" type="text/css"></style> <table class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF; width: 100%;" valign="top" width="100%" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF"> <tbody> <tr style="vertical-align: top;" valign="top"> <td style="word-break: break-word; vertical-align: top;" valign="top"> <div style=""> <div class="block-grid" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num12" style="min-width: 320px; max-width: 500px; display: table-cell; vertical-align: top; width: 500px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;"> <div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:0px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; line-height: 1.2; word-break: break-word; mso-line-height-alt: 17px; margin-top: 0; margin-bottom: 0;"> Mit freundlichen GrÃ¼ÃŸen | Best regards</p></div></div></div></div></div></div></div></div><div style=""> <div class="block-grid two-up" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num3" style="display: table-cell; vertical-align: top; max-width: 320px; min-width: 123px; width: 125px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid #8D8D8D; border-bottom:0px solid transparent; border-right:0px solid #8D8D8D; padding-top:5px; padding-bottom:5px; padding-right: 10px; padding-left: 0px;"> <div class="img-container center autowidth" style="padding-right: 0px;padding-left: 0px;" align="center"> <img class="center autowidth" src="https://spectario.com/wp-content/uploads/2021/08/logo-7-3-icon-1.png" style="text-decoration: none; max-width: 100%; display: block;" moz-do-not-send="true" alt="" width="102" height="148" border="0" align="middle"> </div></div></div></div><div class="col num9" style="display: table-cell; vertical-align: top; max-width: 320px; min-width: 369px; width: 368px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:5px solid #8D8D8D; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 10px;"> <div style="color:#8cc73f;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:0px;padding-right:5px;padding-bottom:0px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #8cc73f; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; font-size: 14px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 17px; margin-top: 0; margin-bottom: 0;"><font color="#289ae3"><strong><span style="font-size: 16px;">Spectario Digital Solutions GmbH</span></strong></font></p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:0px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <strong>Customer Success Manager</strong> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <a href="mailto:service@spectario.com" rel="noopener noreferrer" target="_blank" data-darkreader-inline-color="" style="color: rgb(0, 104, 165); --darkreader-inline-color:#59c1ff;" class="moz-txt-link-freetext" moz-do-not-send="true">service@spectario.com</a> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> Tel.: <a href="tel:004930439737360" rel="noopener noreferrer" target="_blank" data-darkreader-inline-color="" style="color: rgb(0, 104, 165); --darkreader-inline-color:#59c1ff;">030-439 737 360</a> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> Fax: <a href="tel:004930439737361" rel="noopener noreferrer" target="_blank" data-darkreader-inline-color="" style="color: rgb(0, 104, 165); --darkreader-inline-color:#59c1ff;">030-439 737 361</a> </p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <strong>Spectario Digital Solutions GmbH</strong> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;">StresemannstraÃŸe 23 | 10963 Berlin</p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <a href="http://www.spectario.com/" rel="noopener noreferrer" target="_blank"data-saferedirecturl="https://www.google.com/url?q=http://www.spectario.com&amp;source=gmail&amp;ust=1678192225396000&amp;usg=AOvVaw2hUdd2PKJTU2NUigcWP-xJ" data-darkreader-inline-color="" style="color: rgb(0, 104, 165); --darkreader-inline-color:#59c1ff;">www.spectario.com</a><a href="www.movido-media.de" rel="noopener noreferrer" style="color: #0068A5;" target="_blank" moz-do-not-send="true" class="moz-txt-link-freetext"></a> </p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> GeschÃ¤ftsfÃ¼hrer: Mathias Massow<br>Amtsgericht Berlin, HRB 230718<br>Finanzamt Berlin-Charlottenburg<br>USt-Id.: DE348795240</p></div></div></div></div></div></div></div></div><div style=""> <div class="block-grid" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num12" style="min-width: 320px; max-width: 500px; display: table-cell; vertical-align: top; width: 500px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;"> <div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; font-size: 11px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 13px; margin-top: 0; margin-bottom: 0;"> <span style="font-size: 11px;"><strong>Hinweis:</strong> Der Inhalt dieser E-Mail ist vertraulich und ausschlieÃŸlich fÃ¼r den bezeichneten Adressaten bestimmt. Wenn Sie nicht der vorgesehene Adressat dieser E-Mail sein sollten, setzen Sie sich bitte mit dem Absender per E-Mail oder unter der angegebenen Telefonnummer in Verbindung und vernichten Sie diese E-Mail auf Ihren Speichermedien.</span><br><br><span style="font-size: 11px;"><strong>Notice:</strong> The information contained in this e-mail is confidential. It is intended solely for the addressee named above. If you are not the intended recipient, please notify the sender immediately and destroy this message on any media of yours.</span> </p></div></div></div></div></div></div></div></div></td></tr></tbody> </table> </div></body></html>':n.includes("advanto")&&(a='<!DOCTYPE html><html> <head> <meta http-equiv="content-type" content="text/html; charset="> </head> <body> <p>Sehr geehrte'+(t.startsWith("H")||t.startsWith("M")?"r Herr":" Frau")+" "+e+',</p><p>anbei senden wir Ihnen Ihre WebprÃ¤senz Analyseergebnis als PDF Datei zur Kenntnisnahme.<br>Der zustÃ¤ndige Digital Solution Manager wird sich kurzfristig bei Ihnen telefonisch melden, um mit Ihnen die Ergebnisse zu besprechen.</p><p>Bei RÃ¼ckfragen steht Ihnen unser Kundenservice selbstverstÃ¤ndlich gerne zur VerfÃ¼gung. Sie erreichen uns Montags bis Freitags von 9:00 - 17:00 Uhr unter der kostenlosen Service-Hotline 0800 - 2060880 oder per eMail: <a class="moz-txt-link-abbreviated moz-txt-link-freetext" href="mailto:service@aadvanto.de" moz-do-not-send="true">service@aadvanto.de</a></p><div class="moz-signature"><br><meta content="text/html; charset=" http-equiv="Content-Type"> <meta content="width=device-width" name="viewport"> <meta content="IE=edge" http-equiv="X-UA-Compatible"> <title></title> <style type="text/css">body{margin: 0;padding: 0;}table,td,tr{vertical-align: top;border-collapse: collapse;}*{line-height: inherit;}a[x-apple-data-detectors=true]{color: inherit !important;text-decoration: none !important;}</style> <style id="media-query" type="text/css"></style> <style id="icon-media-query" type="text/css"></style> <table class="nl-container" role="presentation" style="table-layout: fixed; vertical-align: top; min-width: 320px; border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #FFFFFF; width: 100%;" valign="top" width="100%" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF"> <tbody> <tr style="vertical-align: top;" valign="top"> <td style="word-break: break-word; vertical-align: top;" valign="top"> <div style=""> <div class="block-grid" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num12" style="min-width: 320px; max-width: 500px; display: table-cell; vertical-align: top; width: 500px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;"> <div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:0px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; line-height: 1.2; word-break: break-word; mso-line-height-alt: 17px; margin-top: 0; margin-bottom: 0;"> Mit freundlichen GrÃ¼ÃŸen | Best regards</p></div></div></div></div></div></div></div></div><div style=""> <div class="block-grid two-up" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num3" style="display: table-cell; vertical-align: top; max-width: 320px; min-width: 123px; width: 125px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid #8D8D8D; border-bottom:0px solid transparent; border-right:0px solid #8D8D8D; padding-top:5px; padding-bottom:5px; padding-right: 10px; padding-left: 0px;"> <div class="img-container center autowidth" style="padding:5px" align="center"> <img class="center autowidth" src="https://aadvanto.de/wp-content/uploads/2020/01/Aadvanto-07012020-300x86.png" style="text-decoration: none; -ms-interpolation-mode: bicubic; height: auto; border: 0; width: 115px; max-width: 100%; display: block;" moz-do-not-send="true" width="115" border="0" align="middle"> </div></div></div></div><div class="col num9" style="display: table-cell; vertical-align: top; max-width: 320px; min-width: 369px; width: 368px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:5px solid #8D8D8D; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 10px;"> \t\t<div style="color:#FF6600;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:0px;padding-right:5px;padding-bottom:0px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #FF6600; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; font-size: 14px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 17px; margin-top: 0; margin-bottom: 0;"> <strong><span style="font-size: 16px;">Laura Kaya</span></strong> </p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:0px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <strong>Customer Success Manager</strong> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <a href="mailto:service@aadvanto.de" rel="noopener noreferrer" style="color: #0068A5;" target="_blank" class="moz-txt-link-freetext" moz-do-not-send="true">service@aadvanto.de</a> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> Kostenlose-Hotline DE: <a href="tel:0800-2060880" rel="noopener noreferrer" style="color: #0068A5;" target="_blank" moz-do-not-send="true">0800-2060880</a> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> Kostenlose-Hotline AT/CH: <a href="tel:0800-206088" rel="noopener noreferrer" style="color: #0068A5;" target="_blank" moz-do-not-send="true">0800-206088</a> </p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <strong>Aadvanto Digital GmbH</strong> </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> KÃ¶nigsallee 27 | 40212 DÃ¼sseldorf </p><p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> <a href="https://aadvanto.de/" rel="noopener noreferrer" style="color: #0068A5;" target="_blank" moz-do-not-send="true">aadvanto.de</a> </p></div></div><div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:5px;padding-right:5px;padding-bottom:5px;padding-left:5px;"> <div class="txtTinyMce-wrapper" style="font-size: 12px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 14px;"> <p style="margin: 0; font-size: 12px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 14px; margin-top: 0; margin-bottom: 0;"> GeschÃ¤ftsfÃ¼hrer: Oliver Griebsch <br>Amtsgericht DÃ¼sseldorf, HRB 88087 <br>Finanzamt DÃ¼sseldorf-Mitte <br>USt-Id.: DE327029035</p></div></div></div></div></div></div></div></div><div style=""> <div class="block-grid" style="min-width: 320px; max-width: 500px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"> <div style="border-collapse: collapse;display: table;width: 100%;"> <div class="col num12" style="min-width: 320px; max-width: 500px; display: table-cell; vertical-align: top; width: 500px;"> <div class="col_cont" style="width:100% !important;"> <div style="border-top:0px solid transparent; border-left:0px solid transparent; border-bottom:0px solid transparent; border-right:0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;"> <div style="color:#555555;font-family:Arial, Helvetica Neue, Helvetica,sans-serif;line-height:1.2;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px;"> <div class="txtTinyMce-wrapper" style="font-size: 14px; line-height: 1.2; color: #555555; font-family: Arial, Helvetica Neue, Helvetica, sans-serif; mso-line-height-alt: 17px;"> <p style="margin: 0; font-size: 11px; line-height: 1.2; word-break: break-word; mso-line-height-alt: 13px; margin-top: 0; margin-bottom: 0;"> <span style="font-size: 11px;"><strong>Hinweis:</strong> Der Inhalt dieser E-Mail ist vertraulich und ausschlieÃŸlich fÃ¼r den bezeichneten Adressaten bestimmt. Wenn Sie nicht der vorgesehene Adressat dieser E-Mail sein sollten, setzen Sie sich bitte mit dem Absender per E-Mail oder unter der angegebenen Telefonnummer in Verbindung und vernichten Sie diese E-Mail auf Ihren Speichermedien.</span><br><br><span style="font-size: 11px;"><strong>Notice:</strong>\t\t The information contained in this e-mail is confidential. It is intended solely for the addressee named above. If you are not the intended recipient, please notify the sender immediately and destroy this message on any media of yours.</span> </p></div></div></div></div></div></div></div></div></td></tr></tbody> </table> </div></body></html>'),a},createBillingLinks:function(e,t=!1,n=!1){if(e&&e.Reseller&&e.Reseller.length>0){let a={inagent:"",product:"",ab:""},r="https://aadvanto-billing.movido.cloud/app/customers/add?",o={};"Aadvanto"==e.Reseller&&t?(r="https://aadvanto-billing.movido.cloud/app/customers/add?",o={CompanyName:"CompanyName",VATId:"TaxID",Website:"Website",CleanNote:"Notes",CountryID:"CountryID",Country:"Country",CurrencyX:"CurrencyID",SubcontractorID:"SubcontractorID",AgentName:"AgentID",TaxRuleID:"TaxRuleID",FirstName:"FirstName",LastName:"LastName",Email:"Email",Salutation:"Gender",Street:"StreetAddress",HouseNumber:"HouseNumber",AdditionalAddress:"AdditionalAddress",City:"City",PostalCode:"Postcode",TelephoneNumber:"Telephone",MobilePhoneNumber:"MobileNumber",LeadID:"LeadID"}):(r="https://crmv.movido-group.de/inagents/index.php?show=com/userverwaltung&action=create&","Spectario"==e.Reseller?r="https://billing.spectario.com/inagents/index.php?show=com/userverwaltung&action=create&":"Aadvanto"==e.Reseller&&(r="https://billing.aadvanto.de/inagents/index.php?show=com/userverwaltung&action=create&"),o={Email:"uemail",CompanyName:"ufirma",FirstName:"uvorname",LastName:"unachname",Street:"uadresse",HouseNumber:"uhausnr",City:"ustadt",PostalCode:"uplz",CountryCode:"uland",TelephoneNumberCode:"uvorwahl",TelephoneNumber:"utelenr",MobilePhoneNumberCode:"umobilvorwahl",MobilePhoneNumber:"umobilnr",CleanNote:"unotes",Subbiz:"ureseller",VATId:"uustid",Salutation:"ugeschlecht",Website:"extrafields[Webseite]",AgentName:"extrafields[AgentWP]"});for(const n in o){let i="";"Aadvanto"==e.Reseller&&t?(e.hasOwnProperty(n)?(i=e[n],"Country"==o[n]||"CountryID"==o[n]?"DE"==e.CountryCode?i="Germany":"AT"==e.CountryCode?i="Austria":"CH"==e.CountryCode&&(i="Switzerland"):"Notes"==o[n]&&e.LeadID&&e.LeadID.length>0&&(i+=` (Lead: ${e.LeadID} - Agent: ${e.AgentName}${e.AgentData&&e.AgentData.location?" / "+e.AgentData.location:""})`)):"TaxRuleID"==o[n]?"DE"==e.CountryCode?i="Germany":"AT"==e.CountryCode?i="Austria":"CH"==e.CountryCode&&(i="Switzerland"):"CurrencyID"==o[n]&&(i="CH"==e.CountryCode?"CHF":"Euro"),"Telephone"==o[n]?i.length>0&&(i=e.TelephoneNumberCode+i):"MobileNumber"==o[n]?i.length>0&&(i=e.MobilePhoneNumberCode+i):"Gender"==o[n]&&(i=/((?<=\s|^)male)|her/gi.test(i)?"Male":"Female")):e.hasOwnProperty(n)&&(i=e[n],"ufirma"==o[n]||"unotes"==o[n]?i=i.replace(/&/g,"%26").replace(/#/g,"%23"):"ugeschlecht"==o[n]?i=/((?<=\s|^)male)|her/gi.test(i)?"maennlich":"weiblich":"ureseller"==o[n]?e.AgentData&&(i=list.subbiz[e.Reseller.toLowerCase()][e.AgentData.location.toLowerCase()],console.log(`list.subbiz[${e.Reseller.toLowerCase()}][${e.AgentData.location.toLowerCase()}] val:`,i,"list movido",list.subbiz.movido)):"uvorwahl"==o[n]?e.TelephoneNumber.length||(i=""):"umobilvorwahl"==o[n]&&(e.MobilePhoneNumber.length||(i=""))),r+=`${o[n]}=${encodeURIComponent(decodeURIComponent(i))}&`}if(a.inagent=r,e.CustomerNumber.length>3){let r=new Date,o=new Date,s=r.getDay();var i=10;3==s&&(i=9),4==s&&(i=8),o.setDate(r.getDate()+i);let l=new Date(o),d=l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear(),c=/^\d+$/.test(e.Subbiz)?e.Reseller:e.Subbiz,p=/^\d+$/.test(e.Subbiz)?e.Subbiz:e.Reseller,u={costid:81,wishnettoprice:parseInt(e.Cost),urebate:30},m=99;switch(c){case"Aadvanto":e.CountryCode.toLowerCase().includes("CH")?(u.costid=32,m=149):(u.costid=40,m=99);break;case"Spectario":e.CountryCode.toLowerCase().includes("CH")?(u.costid=124,m=149):(u.costid=108,m=99);break;case"Movido":if(m=99,!e.CountryCode.toLowerCase().includes("CH")){switch(u.wishnettoprice){case 59:u.costid=80;break;case 69:u.costid=81;break;case 79:u.costid=108;break;case 99:u.costid=118}break}u.costid=124,m=149}u.urebate=m-u.wishnettoprice;let g="https://crmv.movido-group.de";"Spectario"==e.Reseller&&(g="https://billing.spectario.com/"),"Aadvanto"!=e.Reseller||t||(g="https://billing.aadvanto.de/"),a.product=g+"/inagents/index.php?show=com/produktverwaltung&action=add&userid="+e.CustomerNumber+"&uproduct="+u.costid+"&uresellerid="+e.Subbiz+"&ustarttime="+d+("Movido"==e.Reseller&&"CH"!=e.CountryCode)?"":"&wishnettoprice="+u.wishnettoprice+".00&urebate="+u.urebate,n&&(a.product={userid:e.CustomerNumber,uproduct:u.costid,uresellerid:p,ustarttime:d},"Movido"==e.Reseller&&"CH"!=e.CountryCode||(a.product.wishnettoprice=u.wishnettoprice,a.product.urebate=u.urebate)),a.ab=g+"/inagents/index.php?show=com/documentmanager&action=showuserdocuments&userid="+e.CustomerNumber}return a}},cleanWpaDiv:async function(){await new Promise(((e,t)=>{const n=document.getElementById("wpadiv");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);e(!0)}else e(!1)}))},addWpaCheckLine:function({comptype:e,cc:t="-",zip:n="-",name:i="- Can't Parse (Recheck) -",address:a="- Can't Parse (Recheck) -",recheckid:r=null,rechecktoken:o=null}){const s=document.getElementById("clone_div");if(s){const l=s.cloneNode(!0);l.id=`${e}_div`;const d=l.querySelector("#clone_a");d.id=`${e}_a`,d.setAttribute("ubname",i),d.setAttribute("ubstreet",a),d.setAttribute("ubzip",n),d.setAttribute("ubcountry",t),r&&o&&(d.setAttribute("ubrecheckid",r),d.setAttribute("ubrechecktoken",o));let c=d.querySelector("#clone_btn");return c.id=`${e}_btn`,c.name=`${e}_btn`,c.textContent=`${e}:`,c=d.querySelector("#clone_cc"),c.id=`${e}_cc`,c.name=`${e}_cc`,c.textContent=t,c=d.querySelector("#clone_zip"),c.id=`${e}_zip`,c.name=`${e}_zip`,c.textContent=n,c=d.querySelector("#clone_name"),c.id=`${e}_name`,c.name=`${e}_name`,c.textContent=i,c=d.querySelector("#clone_address"),c.id=`${e}_address`,c.name=`${e}_address`,c.textContent=a,l.style.display="",document.getElementById("ubcomp").appendChild(l),l.removeEventListener("click",(()=>{})),l.addEventListener("click",(()=>{steroid.openClickedAnalysis(e)})),l}},editWpaCheckLine:function({comptype:e,cc:t="-",zip:n="-",name:i="- Can't Parse (Recheck) -",address:a="- Can't Parse (Recheck) -",recheckid:r=null,rechecktoken:o=null}){const s=document.getElementById(`${e}_div`);if(s){s.id=`${e}_div`;const l=s.querySelector(`#${e}_a`);l.id=`${e}_a`,l.setAttribute("ubname",i),l.setAttribute("ubstreet",a),l.setAttribute("ubzip",n),l.setAttribute("ubcountry",t),r&&o&&(l.setAttribute("ubrecheckid",r),l.setAttribute("ubrechecktoken",o));let d=l.querySelector(`#${e}_btn`);return d&&(d.id=`${e}_btn`,d.name=`${e}_btn`,d.textContent=`${e}:`),d=l.querySelector(`#${e}_cc`),d&&(d.id=`${e}_cc`,d.name=`${e}_cc`,d.textContent=t),d=l.querySelector(`#${e}_zip`),d&&(d.id=`${e}_zip`,d.name=`${e}_zip`,d.textContent=n),d=l.querySelector(`#${e}_name`),d&&(d.id=`${e}_name`,d.name=`${e}_name`,d.textContent=i),d=l.querySelector(`#${e}_address`),d&&(d.id=`${e}_address`,d.name=`${e}_address`,d.textContent=a),s.style.display="",s}},openClickedAnalysis:function(e){let t=document.getElementById(`${e}_a`);if(t){let e={};e.rechecktoken=t.getAttribute("ubrechecktoken"),e.recheckid=t.getAttribute("ubrecheckid"),e.rechecktoken||e.recheckid||(e.name=t.getAttribute("ubname"),e.zip=t.getAttribute("ubzip"),e.country=t.getAttribute("ubcountry"),e.street=t.getAttribute("ubstreet"));let n=document.getElementById("ubcheckname"),i=document.getElementById("ubcheckaddress"),a=document.getElementById("ubcheckzip");i&&n&&a&&(n.value="",i.value="",a.value="",e.rechecktoken||e.recheckid||(n.value=e.name,i.value=e.street,a.value=e.zip)),steroid.ubcheck(e)}},prepareWpaEntryPos:function(e={}){const t=document.getElementById("wpadiv");if(t)for(const n in e)t.innerHTML=t.innerHTML+`<div id="${n}_Div" style="display:none;"></div>`},addWpaEntry:function({data:e}){const t=document.getElementById("wpadiv");if(t){let n=e.result.html;e.alreadyManaged&&(t.innerHTML="");let i=`<div id="${e.directory}_Div" style="white-space: nowrap; overflow: hidden;display:inline-block;max-width:95%;width:30%;max-height:50px;border:1px solid #2eb9ce;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;padding-top:5px;padding-bottom:5px;padding-left:5px;padding-right:5px"><div style="display:inline-block;max-height:30px><span style=" max-width:%25;max-height:50px"=""><img id="${e.directory}_Logo" alt="" src="${n.logo}" style="max-height:30px;height:%100;margin-right:10px"></div><div id="${e.directory}_Info" style="display:inline-block"><span style="font-size:10px;float:left">${n.name}<br>${n.address}<br></span></div></div>`,a=document.getElementById(`${e.directory}_Div`);a?a.outerHTML=i:t.innerHTML=t.innerHTML+i}},setup:function(e,t=!1){if(document.getElementById("steroid-container")&&document.getElementById("steroid-container").innerHTML.length>3&&e){const s=document.getElementById("copyEmail"),l=document.getElementById("copyBCC"),d=document.getElementById("copyHTML"),c=document.getElementById("copySEO");if(e.LeadID&&e.LeadID.length>3){const w=document.getElementById("aCheckLead");w&&(w.href=`https://v4.dial24.net/admin/?ADD=1121&lead_id=${e.LeadID}`)}if(!t){const C=document.getElementById("seotitle");C&&(C.textContent="SEO Check");const k=document.getElementById("seoCheckbox");if(k&&(k.checked=!1,k.disabled=!0),k&&e.Keywords.length>2&&e.Website.length>2&&e.Website.includes(".")&&!e.Website.endsWith(".")){k.checked=!1,k.disabled=!0;const A=document.getElementById("seodiv"),N=document.getElementById("seoCopyWeb"),I=document.getElementById("seoCopyKeywords"),E=document.getElementById("seoCopyEmail"),S=document.getElementById("seoCheckButton"),D=document.getElementById("copySEO");if(A&&D&&N&&I&&E&&S){function n(){k.checked?A.style.display="block":A.style.display="none",d&&(d.textContent=steroid.createMailIndex(e.LastName,e.Salutation,e.Reseller,k.checked))}k.removeEventListener("change",(()=>{})),k.addEventListener("change",n),N.value=e.Website,I.value=e.Keywords.replace(/'|,|\/|\sin\s|\smit\s|\sim\s|\s\s+/gi," "),E.value=e.Email,S.removeEventListener("click",(()=>{})),S.addEventListener("click",(function(){S.setAttribute("disabled","true"),I.setAttribute("disabled","true"),N.setAttribute("disabled","true"),E.setAttribute("disabled","true"),D.setAttribute("disabled","true"),N.value.length&&I.value.length&&E.value.length||(console.log("[MySiteAuditor] Value missing"),S.removeAttribute("disabled"),I.removeAttribute("disabled"),N.removeAttribute("disabled"),E.removeAttribute("disabled"),D.removeAttribute("disabled")),chrome.runtime.sendMessage({action:"mysiteauditor",subaction:"seoCheck",params:[N.value,E.value,I.value,null,e.Reseller,D.value]},(function(e){E.removeAttribute("disabled"),S.removeAttribute("disabled"),I.removeAttribute("disabled"),N.removeAttribute("disabled"),D.removeAttribute("disabled")}))})),"Movido"==e.Reseller&&(e.Keywords==e.Industry||e.Keywords.length<2&&e.Industry.length>2?(C.textContent=C.textContent="SEO Check (optionell)",k.checked=!1):k.checked=!0,k.disabled=!1,n())}}}const p=document.getElementById("mxEmail"),u=document.getElementById("mxValidity"),m=document.getElementById("mxReason"),g=document.getElementById("notes");if(g&&(g.innerHTML=e.CleanNote.replace(/\n/gim,"<br>")),p){function i(t){let n={class:void 0,text:"checking..."},i={class:void 0,text:"checking..."};u.className="copybtn",m.className="copybtn",t.includes("t-online")||t.includes("aol.de")||t.includes("yahoo")?(n.text="[ Nicht ÃœberprÃ¼fbar ]",i.text="[ Nicht ÃœberprÃ¼fbar ]"):check.mx(t).then((t=>{if(console.log("MX",t),t.email==p.value){switch(e.Email=p.value,t.status){case"valid":n.text="Valid",n.class="valid",i.text="Accepted Email",i.class="valid";break;case"invalid":n.text="Invalid",n.class="invalid",i.class="invalid",t.format_valid?t.server_connection?t.server_response?t.mx_found?t.valid_user||(i.text="Invalid User"):i.text="No MX":i.text="Server Response":i.text="Server Connection":list.regex.email.test(p.value)?(n.class=void 0,n.text="Check Error",i.text="Check Error",i.class=void 0):i.text="Syntax/Format";break;case"unknown":n.text="Unknown",n.class="warning";break;default:n.text="?",n.class=void 0,i.text="?",i.class=void 0}t.catch_all&&(n.class="valid",n.text="Valid (!)",i.class="warning",i.text="Catch-All"),u.textContent=n.text,n.class&&u.classList.add(n.class),m.textContent=i.text,i.class&&m.classList.add(i.class)}})),u.textContent=n.text,n.class&&u.classList.add(n.class),m.textContent=i.text,i.class&&m.classList.add(i.class)}p.value=e.Email,p.removeEventListener("change",(()=>{})),p.addEventListener("change",(()=>{i(p.value)})),t||i(p.value)}const h=document.getElementById("vatInput"),b=document.getElementById("vatName"),y=document.getElementById("vatAddress");if(h&&e.VATId&&e.VATId.length>5){function a(t){e.VATId=h.value;let n={class:void 0,text:"checking..."},i={class:void 0,text:"checking..."};b.textContent=n.text,b.className="copybtn",y.textContent=i.text,y.className="copybtn",check.vat(t).then((e=>{e&&e.vat_number?h.value.includes(e.vat_number.replace(/\D/gi,""))&&(e.valid?(n={class:"valid",text:e.name},i={class:"valid",text:e.address.replace(/\n/gi," ")}):(n={class:"invalid",text:"Invalid"},i={class:"invalid",text:"Invalid"})):(console.log(e),n={class:void 0,text:"Check Error"},i={color:void 0,text:"Check Error"}),b.textContent=n.text,n.class&&b.classList.add(n.class),y.textContent=i.text,i.class&&y.classList.add(i.class)}))}h.value=e.VATId,h.removeEventListener("change",(()=>{})),h.addEventListener("change",(()=>{a(h.value)})),t||a(e.VATId)}if(s&&(s.textContent=e.Email),l&&(l.textContent=`${e.CustomerNumber}@kunden.${"Spectario"==e.Reseller?"spectario.com":"Aadvanto"==e.Reseller?"aadvanto.de":"movido-media.de"}`),d&&(d.textContent=steroid.createMailIndex(e.LastName,e.Salutation,e.Reseller,seoCheckbox.checked)),c){c.value=`SEO CHECK ${e.CustomerNumber}.pdf`;const T=document.getElementById("seoCheckButton"),L=document.getElementById("seoCheckbox");L&&L.checked&&e.CustomerNumber.length&&T&&!T.disabled&&T.click()}const f=document.getElementById("copyLeadName");if(f&&(f.textContent=`${e.LeadID} ${e.AgentName} ${e.AgentData?" / "+e.AgentData.location:""}`),e.Analysis&&e.Analysis.length>1){const z=document.getElementById("analysisCount");z&&(z.textContent=`${e.Analysis.length} Analysen`,z.style.display="block")}const v=document.getElementById("priceDifference");if(v&&e.CostNotes&&(v.innerHTML=`Tarif: ${e.Cost},00â‚¬<br>Hinweisfeld: ${e.CostNotes},00â‚¬`,v.style.display="block"),!t){const P=document.getElementById("doublets"),_=document.querySelector("fieldset#Doublets");P&&chrome.runtime.sendMessage({action:"infotec",subaction:"searchCustomerByData",params:[e,"movido"]},(function(t){let n=t;n.length&&(_.style.display="block"),chrome.runtime.sendMessage({action:"infotec",subaction:"searchCustomerByData",params:[e,"aadvanto"]},(function(t){n.concat(t),n.length&&(_.style.display="block"),chrome.runtime.sendMessage({action:"infotec",subaction:"searchCustomerByData",params:[e,"spectario"]},(function(e){if(n.concat(e),n.length&&(_.style.display="block"),n.length){let e="";n.forEach((t=>{e+=`<a href="${t.url}" target="_blank">${t.reseller[0]}${t.label}</a>`})),P.innerHTML=e}}))}))}));let H="DAT";const $=document.getElementById("ubcomp");steroid.addWpaCheckLine({comptype:H,cc:e.CountryCode,zip:e.PostalCode,name:e.CompanyName,address:e.Street+" "+e.HouseNumber});for(var r=0;r<e.Analysis.length;r++){let M="ANL"+(r+1),B={comptype:M,cc:e.Analysis[r].country,zip:e.Analysis[r].zip,name:e.Analysis[r].name,address:e.Analysis[r].street,recheckid:e.Analysis[r].recheckid,rechecktoken:e.Analysis[r].rechecktoken};if(!e.Analysis[r].name&&e.Analysis[r].recheckid&&e.Analysis[r].recheckid.length>0&&(B={comptype:M,recheckid:e.Analysis[r].recheckid,rechecktoken:e.Analysis[r].rechecktoken},uberall)){let F={public_key:null,recheckid:e.Analysis[r].recheckid,rechecktoken:e.Analysis[r].rechecktoken};uberall.getRecheckInfo(F).then((e=>{console.log("data in burecheck",e),e&&(console.log("Data from getRecheckInfo:",e),steroid.editWpaCheckLine({comptype:M,cc:e.country.toLowerCase(),zip:e.zip,name:e.name,address:e.street+(e.streetNo.length?" "+e.streetNo:"")}))}))}steroid.addWpaCheckLine(B)}check.place({name:e.CompanyName,address:e.Street,nr:e.HouseNumber,zip:e.PostalCode,number:e.TelephoneNumberCode+e.TelephoneNumber,ccode:e.CountryCode,website:e.Website}).then((t=>{console.log("LBD Data:",t);let n=!0;if(t){t.address=correctStr(t.address),t.street=correctStr(t.street);let i={comptype:"LBD",cc:t.ccode,zip:t.zip,name:t.name,address:t.address},a=e.Analysis.length>0&&0==e.Analysis[0].recheckid.length?{name:e.Analysis[0].name.toLowerCase().replace(/\s/g,""),address:correctStr(e.Analysis[0].street).toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/\s/g,"")}:{name:e.CompanyName.toLowerCase().replace(/\s/g,""),address:correctStr(e.Street).toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/\s/g,"")+e.HouseNumber.toLowerCase()};if(a.address!=a.name&&(a.name!=i.name.toLowerCase().replace(/\s/g,"")||a.address!=i.address.replace(/\s\(.*/gi,"").toLowerCase().replace(/(ÃŸ|%C3%9F)/gi,"ss").replace(/\s/g,""))&&(t.phone&&t.phone.length&&(e.TelephoneNumber.length&&t.phone.includes(e.TelephoneNumber)||e.MobilePhoneNumber&&t.phone.includes(e.MobilePhoneNumber))||e.Website.length&&t.website.length&&e.Website.replace(/([^a-zA-Z0-9])/gi,"").includes(t.website.replace(/([^a-zA-Z0-9])/gi,"")))){let e=steroid.addWpaCheckLine(i);n=!1,e&&e.click()}}n&&$.lastChild.click()}))}const x={addCustomer:document.getElementById("addCustomer"),bookProduct:document.getElementById("addProduct"),sendAb:document.getElementById("sendAb")};if(x.addCustomer&&x.bookProduct&&x.sendAb){function o(e){let t=window.location.href.includes("spectario")?"billing.spectario.com":window.location.href.includes("aadvanto")?"billing.aadvanto.de":"crmv.movido-group.de";const n={addCustomer:document.getElementById("addCustomer"),bookProduct:document.getElementById("addProduct"),sendAb:document.getElementById("sendAb")};e&&e.length&&/^\d+$/gi.test(e)&&(n.addCustomer.textContent=`Show ${e}`,n.addCustomer.disabled=!1,n.addCustomer.outerHTML=`<a target="_blank" href="https://${t}/inagents/index.php?show=com/kundenuebersicht&action=showuser&id=${e}">${n.addCustomer.outerHTML}</a>`,n.bookProduct.disabled=!1)}o(e.CustomerNumber),t||(x.addCustomer.disabled=!1,x.addCustomer.removeEventListener("click",(()=>{})),x.addCustomer.addEventListener("click",(()=>{/\d+/gi.test(x.addCustomer.textContent)||(x.addCustomer.disabled=!0,x.addCustomer.innerHTML='<img src="https://i.gifer.com/ZZ5H.gif" height="60%">',chrome.runtime.sendMessage({action:"infotec",subaction:"addCustomer",params:[e]},(function(t){t&&(e.CustomerNumber=t,o(t),steroid&&steroid.setup(e,!0))})))})),x.bookProduct.removeEventListener("click",(()=>{})),x.bookProduct.addEventListener("click",(()=>{x.bookProduct.disabled=!0,x.bookProduct.innerHTML='<img src="https://i.gifer.com/ZZ5H.gif" height="60%">';let t=steroid.createBillingLinks(e,!1,!0);console.log("Prod:",t,"Order:",e),t&&t.product?chrome.runtime.sendMessage({action:"infotec",subaction:"bookProduct",params:[t.product]},(function(e){x.bookProduct.innerHTML=e?"Product booked!":"ERROR Booking",chrome.runtime.sendMessage({action:"infotec",subaction:"getCustomerLastUnsentAb",params:[e]},(function(e){x.sendAb.disabled=!e,e&&(x.sendAb.setAttribute("documentid",e),x.sendAb.textContent="Send AB: "+e)}))})):console.log("No prod/prod.product?",t)})),x.sendAb.addEventListener("click",(()=>{x.sendAb.disabled=!0,x.sendAb.innerHTML='<img src="https://i.gifer.com/ZZ5H.gif" height="60%">';let e=x.sendAb.getAttribute("documentid");e&&chrome.runtime.sendMessage({action:"infotec",subaction:"sendCustomerAb",params:[e]},(function(e){e&&(x.sendAb.innerHTML=e?"AB sent!":"AB failed!")}))})))}}}};export async function getList(){if(list)return list;let e=await fetch("https://cdn.jsdelivr.net/gh/gokhan-akin/xact-ext-settings@latest/list.json");return e&&(list=await e.json()),list?(list.regex={analysis:/(http|https):\/\/(www\.)?(xact-solution\.com|spectario\.com\/check\/\?|movido-media\.de\/(meinwpa|web-presence-analysis)\/\?|movido-media\.at\/mein-test\/\?|aadvanto\.de\/(wpa-check|analyse-der-webpraesenz)\/\?).*?((ubcity|ubrechecktoken|ubrecheckid)=?[.*^\S]+)/gi,analysisrm:/(Analyse:\s*)?(http|https):\/\/(www\.)?(xact-solution\.com|spectario\.com\/check\/\?|movido-media\.de\/(meinwpa|web-presence-analysis)\/\?|movido-media\.at\/mein-test\/\?|aadvanto\.de\/(wpa-check|analyse-der-webpraesenz)\/\?).*?((ubcity|ubrechecktoken|ubrecheckid)=?[.*^\S]+)(.*&autostart=true)?/gi,cost:/(\b)(6|7|9)9(,|\s|\.|â‚¬|-|[A-Za-z])/gim,costrm:/(\d9.*?\s+?.*?dy(\s)?(nummer)?)?((web)?[a-zA-Z]{6,9}\s+(m|o).{1,4}\s+h[a-zA-Z]{2,12}(\s+[0-9]9(\s+)?(euro|â‚¬|e)(\.)?\s+)?)?/gim,housenumber:/(?<=\s)[0-9\-]+([a-zA-Z])?$/gi,email:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g},list):null}getList().then((e=>{list=e}));export var list=void 0;